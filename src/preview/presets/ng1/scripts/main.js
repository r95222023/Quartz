!function(){"use strict";angular.module("quartz.components",["ui.router","pascalprecht.translate"])}(),function(){"use strict";function e(){var e=0;window._FBUsg=this,this.useBandwidth=function(t){e+=angular.isNumber(t)?t:encodeURI(JSON.stringify(t)).split(/%..|./).length-1,console.log("usage:",e)}}angular.module("quartz.components").service("$usage",e)}(),function(){"use strict";function e(e,t){return function(n){return new Promise(function(r,o){e.ref("file-path?path=il8n/"+n.key+".json").getDownloadURL().then(function(e){t.get(e).then(function(e){r(e.data)},function(e){o(e)})})})}}e.$inject=["$firebaseStorage","$http"],angular.module("quartz.components").factory("fbStorageLoader",e)}(),function(){"use strict";function e(e){function t(e){var t={},n=e||{};return _core.util.site.siteName&&(t.siteName=_core.util.site.siteName),n.params?n.params=Object.assign(t,n.params):n=Object.assign(t,n),n}function n(e,n){return _core.util.storage.getWithCache(e,t(n))}function r(e,n,r,o){return _core.util.storage.update(e,n,r,t(o))}function o(e,n){return _core.util.storage.ref(e,t(n))}function i(e){return Array.isArray(e)?e[Math.floor(Math.random()*e.length)]:e}function a(e,t,n,r,a){return new Promise(function(u,c){var s="function"==typeof a?a:function(){},l="function"==typeof r?r:function(){},f=o(e,{isJs:!1}),d=o(t,{isJs:!1});f.getMetadata().then(function(e){var t=i(e.downloadURLs),r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",l(e),r.onload=function(){if(200==this.status){var t=new window.Blob([r.response],{type:e.contentType});d.put(t).on("state_changed",s,c,function(){n&&f.delete(),u()}),u()}},r.addEventListener("error",function(){c("GET error:"+r.status)}),r.send()})})}function u(e,t){return o(e,t).delete()}function c(){for(var e in g)delete g[e].load}function s(e,t){return g[e]=g[e]||{},"loaded"===g[e].load?g[e].val:void("loading"!==g[e].load&&(g[e].load="loading",n(e).then(function(n){g[e]={val:"function"==typeof t?t(n):n,load:"loaded"}})))}function l(e){var t=e+"",n=/url\(['"][\s\S]*?['"]\)/gm,r=t.match(n)||[],o=[];return r.forEach(function(e,t){var n=e.match(/url\(['"]?([\s\S]*?)["']?\)/m)[1];n=n.replace("../",""),o[t]=-1===e.search("//")?d.ref("file-path?path="+n).getDownloadURL():Promise.resolve(n)}),new Promise(function(n,i){r.length?Promise.all(o).then(function(e){e.forEach(function(n,o){t=t.replace(r[o],"url('"+e[o]+"')")}),n(t)}).catch(i):n(e)})}function f(e){var t=new FileReader;return new Promise(function(n){t.addEventListener("loadend",function(t){l(t.srcElement.result).then(function(r){if(r===t.srcElement.result)n(e);else{var o=new Blob([r],{type:"text/css"});n(o)}}).catch(function(t){console.log(t),n(e)})}),t.readAsText(e)})}var d={get:s,getWithCache:n,copy:a,update:r,remove:u,ref:o,getSingleDownloadUrl:i,clearTemp:c,fixCSSFile:f,storages:{}},g={};return window._getFBS=function(t){window._getGetFBS()(t,function(){e(angular.noop,0)})},d}e.$inject=["$timeout"],angular.module("quartz.components").factory("$firebaseStorage",e)}(),function(){"use strict";function e(){function e(e,t){for(var n=e.length;n--;)e[n]===t&&e.splice(n,1)}function t(e){function t(e){var t=Number(e);return!t%1===0&&t>-1?t:!1}function n(e){var r=[],o={},i=!0;return angular.forEach(e,function(e,o){var a=t(o);return a===!1?(i=!1,!1):void(r[o]=angular.isObject(e)?n(e):e)}),i===!1&&angular.forEach(e,function(e,t){o[t]=angular.isObject(e)?n(e):e}),i?r:o}return n(e)}function n(e,t,n){var r;return function(){var o=this,i=arguments,a=function(){r=null,n||e.apply(o,i)},u=n&&!r;clearTimeout(r),r=setTimeout(a,t),u&&e.apply(o,i)}}function r(e){var t=JSON.stringify(e).replace("undefined","null");return JSON.parse(t)}function o(e){return 10>e?"0"+e:e+""}function i(e,t,n){var r=document.createElement("a"),o=e;document.body.appendChild(r),r.style="display: none",""===t.split(".json")[1]&&(o=JSON.stringify(e));var i=new Blob([o],{type:n||"text/plain"}),a=window.URL.createObjectURL(i);r.href=a,r.download=t,r.click(),window.URL.revokeObjectURL(a)}function a(e,t){var n=document.createElement("a");t&&(n.download=t),n.href=e,n.click()}function u(e,t){var n=new XMLHttpRequest;n.responseType="blob",n.onload=function(){var e=new FileReader;e.onloadend=function(){t(e.result)},e.readAsDataURL(n.response)},n.open("GET",e),n.send()}function c(e,t,n){var r=n||"";e&&e._content?angular.forEach(e._content,function(n,o){"__created"!==o&&c(e[o]||n,t,r+"/"+n.name)}):t(e,r)}return{debounce:n,to2dig:o,saveData:i,downloadURI:a,toDataUrl:u,getFirebaseArrayData:t,removeItemFromArray:e,rectifyUpdateData:r,iterateFileTree:c}}angular.module("quartz.components").factory("snippets",e)}(),function(){"use strict";function e(e,t,n,r,o,i,a){function u(){return l.promise}function c(e,n){console.log("Initializing "+e),a.$broadcast("site:change",e),_core.util.site.changeTitle(e),s.siteName=e,s.config={},s.preLoading=!0,"customPage"===n.name||"previewFrame"===n.name?_core.util.site.getSitePreload().then(function(e){var n=e||{};console.log(e),i.loadSite(n).then(function(){if(s.config=n,n.title&&_core.util.site.changeTitle(n.title),n.favicon){var e=n.favicon;-1!==n.favicon.search("//")?_core.util.site.changeFavicon(e):t.ref("file-path?path="+e,{isJs:!1}).getDownloadURL().then(function(e){_core.util.site.changeFavicon(e)})}delete s.preLoading,a.sitesService=s,l.resolve(s)})}):l.resolve(s)}var s={setSite:c,onReady:u,siteName:"_default_"},l=r.defer();return s}function t(e,t,n){e.onBefore({to:"**"},function(e){var t,r=e.to(),o=e.from(),i=e.params("to");n.pageName=i.pageName;var a=_core.util.site.siteName;return a&&""===o.name?n.setSite(a,r):""!==a&&a!==_core.util.site.siteName,t?!1:r})}e.$inject=["$firebase","$firebaseStorage","snippets","$q","indexService","$lazyLoad","$rootScope"],t.$inject=["$transitions","$state","sitesService"],angular.module("quartz.components").service("sitesService",e).run(t)}(),function(){angular.module("quartz.components").config(["$provide",function(e){e.decorator("ngCloakDirective",["$delegate","$auth",function(e,t){var n=e[0],r=n.compile;return n.compile=function(e,o){t.waitForAuth().then(function(){r.call(n,e,o)})},e}])}])}(),function(){"use strict";var e=[];angular.module("quartz.components").config(["$stateProvider",function(t){t.stateAuthenticated=function(n,r){return e.push(n),r.resolve=r.resolve||{},r.resolve.authData=["$auth",function(e){return e.requireAuth()}],t.state(n,r),this}}]).run(["$rootScope","$transitions","$location","$state","$auth","config",function(t,n,r,o,i,a){function u(e){!e&&c(o.current.name)&&(console.log("check failed",e,r.path()),o.go(a.loginRedirectState))}function c(t){return console.log("authRequired?",t,e.indexOf(t)),-1!==e.indexOf(t)}i.onAuthStateChanged(u),n.onError({to:"**"},function(e){"AUTH_REQUIRED"===e.error()&&o.transitionTo(a.loginRedirectState)})}])}(),function(){"use strict";function e(e,t,n){function r(e){var n=[];return e.forEach(function(e,r){n[r]=-1===e.search("//")?t.ref("file-path?path="+e).getDownloadURL():Promise.resolve(e)}),Promise.all(n)}function o(e){if("string"==typeof e)return null!==e.match(/\.css$/);if("object"==typeof e){var t=e.src||e.href;return"stylesheet"===e.rel||null!==t.match(/\.css$/)}}function i(e){if("string"==typeof e)return null!==e.match(/\.js/);if("object"==typeof e){var t=e.src||e.href;return"text/javascript"===e.type||null!==t.match(/\.js$/)}}function a(e,t){var a=e||[],u=[],c=[];return a.forEach(function(e){e.src=e.src||e.href||"",o(e)&&c.push(e.src),i(e)&&!e.defer&&u.push(e.src)}),r(c).then(function(e){e.forEach(function(e,r){n.set("style"+t+r,e,!0)})}),new Promise(function(e,t){r(u).then(function(t){e({serie:!0,files:t})}).catch(t)})}function u(t,r,o){var i=t||{},u=i.sources;n.setDirectly("style"+o,i.css,!0),u?a(u,o).then(function(t){t.files.length?e.load(t).then(function(){r(i),console.log(i)}):r(i)}):r(i)}function c(e,t){return new Promise(function(n){var r=t,o=r.replace(/\s+/g,"");angular.isObject(e)?u(e,n,o):_core.util.site.loadPage("",t).then(function(e){u(e,n,o)})})}function s(t){return new Promise(function(n){t.sources?a(t.sources,"selectedSite").then(function(t){t.files.length?e.load(t).then(function(){n()}):n()}):n()})}return{getDownloadUrls:r,load:c,loadSite:s}}e.$inject=["$ocLazyLoad","$firebaseStorage","injectCSS"],angular.module("quartz.components").factory("$lazyLoad",e)}(),function(){"use strict";function e(e){function t(e,t,n,r){return o("add",r||!1,e,t,n)}function n(e,t,n,r){return o("update",r||!1,e,t,n)}function r(e,t,n){return o("remove",n||!1,e,t)}function o(t,n,r,o,i){if(!n&&!_core.util.site.siteName)return void console.log("Please select a site or enter an index");var a={_state:"index"};return a.index="string"==typeof n?n:_core.util.site.siteName,angular.isString(t)&&(a.task=t),angular.isString(r)&&(a.type=r),angular.isString(o)&&(a.id=o),i&&(a.body=i),e.queryRef("queue-tasks").push(a)}return{add:t,update:n,remove:r}}e.$inject=["$firebase"],angular.module("quartz.components").service("indexService",e)}(),function(){"use strict";angular.module("quartz.components").provider("Keepalive",function(){var e={http:null,interval:600};this.http=function(t){if(!t)throw new Error("Argument must be a string containing a URL, or an object containing the HTTP request configuration.");angular.isString(t)&&(t={url:t,method:"GET"}),t.cache=!1,e.http=t};var t=this.interval=function(t){if(t=parseInt(t),isNaN(t)||0>=t)throw new Error("Interval must be expressed in seconds and be greater than 0.");e.interval=t};this.$get=["$rootScope","$log","$interval","$http",function(n,r,o,i){function a(e,t){n.$broadcast("KeepaliveResponse",e,t)}function u(){n.$broadcast("Keepalive"),angular.isObject(e.http)&&i(e.http).success(a).error(a)}var c={ping:null};return{_options:function(){return e},setInterval:t,start:function(){return o.cancel(c.ping),c.ping=o(u,1e3*e.interval),c.ping},stop:function(){o.cancel(c.ping)},ping:function(){u()}}}]}).provider("Idle",function(){var e={idle:1200,timeout:30,autoResume:"idle",interrupt:"mousemove keydown DOMMouseScroll mousewheel mousedown touchstart touchmove scroll",keepalive:!0},t=this.timeout=function(t){if(t===!1)e.timeout=0;else{if(!(angular.isNumber(t)&&t>=0))throw new Error("Timeout must be zero or false to disable the feature, or a positive integer (in seconds) to enable it.");e.timeout=t}};this.interrupt=function(t){e.interrupt=t};var n=this.idle=function(t){if(0>=t)throw new Error("Idle must be a value in seconds, greater than 0.");e.idle=t};this.autoResume=function(t){e.autoResume=t===!0?"idle":t===!1?"off":t},this.keepalive=function(t){e.keepalive=t===!0},this.$get=["$interval","$log","$rootScope","$document","Keepalive","IdleLocalStorage","$window",function(r,o,i,a,u,c,s){function l(){e.keepalive&&($.running&&u.ping(),u.start())}function f(){e.keepalive&&u.stop()}function d(){$.idling=!$.idling;var t=$.idling?"Start":"End";i.$broadcast("Idle"+t),$.idling?(f(),e.timeout&&($.countdown=e.timeout,g(),$.timeout=r(g,1e3,e.timeout,!1))):l(),r.cancel($.idle)}function g(){return $.countdown<=0?void p():(i.$broadcast("IdleWarn",$.countdown),void $.countdown--)}function p(){f(),r.cancel($.idle),r.cancel($.timeout),$.idling=!0,$.running=!1,$.countdown=0,i.$broadcast("IdleTimeout")}function m(e,t,n){var r=e.running();e.unwatch(),t(n),r&&e.watch()}function h(){var e=c.get("expiry");return e&&e.time?new Date(e.time):null}function v(e){e?c.set("expiry",{id:w,time:e}):c.remove("expiry")}var $={idle:null,timeout:null,idling:!1,running:!1,countdown:null},w=(new Date).getTime(),y={_options:function(){return e},_getNow:function(){return new Date},getIdle:function(){return e.idle},getTimeout:function(){return e.timeout},setIdle:function(e){m(this,n,e)},setTimeout:function(e){m(this,t,e)},isExpired:function(){var e=h();return null!==e&&e<=this._getNow()},running:function(){return $.running},idling:function(){return $.idling},watch:function(t){r.cancel($.idle),r.cancel($.timeout);var n=e.timeout?e.timeout:0;t||v(new Date((new Date).getTime()+1e3*(e.idle+n))),$.idling?d():$.running||l(),$.running=!0,$.idle=r(d,1e3*e.idle,0,!1)},unwatch:function(){r.cancel($.idle),r.cancel($.timeout),$.idling=!1,$.running=!1,v(null),f()},interrupt:function(t){return $.running?e.timeout&&this.isExpired()?void p():void(("idle"===e.autoResume||"notIdle"===e.autoResume&&!$.idling)&&this.watch(t)):void 0}};a.find("html").on(e.interrupt,function(e){"mousemove"===e.type&&e.originalEvent&&0===e.originalEvent.movementX&&0===e.originalEvent.movementY||("mousemove"!==e.type||angular.isUndefined(e.movementX)||e.movementX||e.movementY)&&y.interrupt()});var b=function(e){if("ngIdle.expiry"===e.key&&e.newValue&&e.newValue!==e.oldValue){var t=angular.fromJson(e.newValue);if(t.id===w)return;y.interrupt(!0)}};return s.addEventListener?s.addEventListener("storage",b,!1):s.attachEvent("onstorage",b),y}]}).provider("Title",function(){function e(e,t,n){return new Array(t-String(e).length+1).join(n||"0")+e}var t={enabled:!0},n=this.enabled=function(e){t.enabled=e===!0};this.$get=["$document","$interpolate",function(r,o){var i={original:null,idle:"{{minutes}}:{{seconds}} until your session times out!",timedout:"Your session has expired."};return{setEnabled:n,isEnabled:function(){return t.enabled},original:function(e){return angular.isUndefined(e)?i.original:void(i.original=e)},store:function(e){(e||!i.original)&&(i.original=this.value())},value:function(e){return angular.isUndefined(e)?r[0].title:void(r[0].title=e)},idleMessage:function(e){return angular.isUndefined(e)?i.idle:void(i.idle=e)},timedOutMessage:function(e){return angular.isUndefined(e)?i.timedout:void(i.timedout=e)},setAsIdle:function(t){this.store();var n={totalSeconds:t};n.minutes=Math.floor(t/60),n.seconds=e(t-60*n.minutes,2),this.value(o(this.idleMessage())(n))},setAsTimedOut:function(){this.store(),this.value(this.timedOutMessage())},restore:function(){this.original()&&this.value(this.original())}}}]}).service("IdleStorageAccessor",["$window",function(e){return{get:function(){return e.localStorage}}}]).service("IdleLocalStorage",["IdleStorageAccessor",function(e){function t(){var e={};this.setItem=function(t,n){e[t]=n},this.getItem=function(t){return"undefined"!=typeof e[t]?e[t]:null},this.removeItem=function(t){e[t]=void 0}}function n(){try{var n=e.get();return n.setItem("ngIdleStorage",""),n.removeItem("ngIdleStorage"),n}catch(r){return new t}}var r=n();return{set:function(e,t){r.setItem("ngIdle."+e,angular.toJson(t))},get:function(e){return angular.fromJson(r.getItem("ngIdle."+e))},remove:function(e){r.removeItem("ngIdle."+e)},_wrapped:function(){return r}}}]).run(["$rootScope","Idle",function(e,t){e.$on("IdleStart",function(){console.log("idle start")}),e.$on("IdleEnd",function(){console.log("idle end")}),e.user&&e.user.admin||t.watch()}])}(),function(){"use strict";angular.module("quartz.components").directive("idleCountdown",["Idle",function(e){return{restrict:"A",scope:{value:"=idleCountdown"},link:function(t){t.value=e.getTimeout(),t.$on("IdleWarn",function(e,n){t.$evalAsync(function(){t.value=n})}),t.$on("IdleTimeout",function(){t.$evalAsync(function(){t.value=0})})}}}]).directive("title",["Title",function(e){return{restrict:"E",link:function(t,n,r){e.isEnabled()&&!r.idleDisabled&&(e.store(!0),t.$on("IdleStart",function(){e.original(n[0].innerText)}),t.$on("IdleWarn",function(t,n){e.setAsIdle(n)}),t.$on("IdleEnd",function(){e.restore()}),t.$on("IdleTimeout",function(){e.setAsTimedOut()}))}}}])}(),function(){"use strict";function e(e,t){function n(e,t){var n={},r=t||{};return _core.util.site.siteName&&(n.siteName=_core.util.site.siteName),r.params?r.params=Object.assign(n,r.params):r=Object.assign(n,r),_core.util.database.queryRef(e,r)}function r(e,t,n){var r=_core.util.site.siteName?_core.util.site.siteName:"",o=Object.assign({siteName:r},n),i=Array.isArray(e)?e:[e];return _core.util.database.update(i,t,o)}function o(e,t){return r(e,{compressed:_core.encoding.compress(t),editTime:firebase.database.ServerValue.TIMESTAMP})}function i(e,t,r,o){return new Promise(function(i,a){var u=o||{},c=n(e,u.src);c.once("value").then(function(e){n(t,u.dest)[u.set===!0?"set":"update"](e.val()).then(function(){r?c.set(null).then(i):i()})}).catch(a)})}function a(e,t){return new Promise(function(r,o){var i=t||{},a={},u=n(e,Object.assign(i,{params:i.params||{}}));u.once("value",function(e){e.forEach(function(e){var t=e.val(),n=e.key;a[n]={name:(i.fileName?t[i.fileName]:n)+(i.fileExtension||".js"),date:t.editTime,type:"file"}}),r(a)}).catch(o)})}function u(r,o){function i(t){e(function(){c.result.hits=t.hits||[]},0)}var a=o||{},u=n(r),c=new _core.util.database.Pagination(u,Object.assign({filter:function(e,n){return t("orderBy")(e,n.orderBy)}},a),i);return c.size=10,c.page=1,c.onReorder=function(e){c.get(c.page,c.size,e)},c}function c(e,t){return _core.util.database.request(e,t)}function s(e){var t=e,n=[[/\./g,"^%0"],[/#/g,"^%1"],[/\$/g,"^%2"],[/\[/g,"^%3"],[/\]/g,"^%4"]];return angular.forEach(n,function(e){t=t.replace(e[0],e[1])}),t}function l(e,t){return _core.util.database.getWithCache(e,t)}var f={queryRef:n,update:r,copy:i,getFileTableFromList:a,pagination:u,request:c,updateCacheable:o,getValidKey:s,getWithCache:l};return f}e.$inject=["$timeout","$filter"],angular.module("quartz.components").factory("$firebase",e)}(),function(){"use strict";angular.module("quartz.components").filter("reverse",function(){return function(e){return e.slice().reverse()}}).filter("relativeTime",["$translate","$timeout",function(e,t){function n(e,t){return Math.round(Math.abs(e-t)/1e3)}function r(e,t){var r=t||new Date;e instanceof Date||(e=new Date(e));var o,i=60,a=60*i,u=24*a,c=7*u,s=30*u,l=365*u,f=n(r,e),d=1;return f>u&&c>f&&(e=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0),f=n(r,e)),30>f?(o="JUST",d=0):i>f?(o="SECS",d=f):2*i>f?o="MIN":a>f?(o="MINS",d=Math.floor(f/i)):1===Math.floor(f/a)?o="HOUR":u>f?(o="HOURS",d=Math.floor(f/a)):2*u>f?o="DAY":c>f?(o="DAYS",d=Math.floor(f/u)):1===Math.floor(f/c)?o="WEEK":s>f?(o="WEEKS",d=Math.floor(f/c)):1===Math.floor(f/s)?o="MONTH":l>f?(o="MONTHS",d=Math.floor(f/s)):1===Math.floor(f/l)?o="YEAR":(o="YEARS",d=Math.floor(f/l)),[d,"DATE."+o]}function o(n){if(n){if(a[n])return a[n];if(!i[n]){i[n]=!0;var o=new Date(n);_core.syncTime().then(function(u){var c=r(o,new Date(u())),s=function(e){t(function(){a[n]=e.split(" ")[1]||!c[0]?e:c[0]+" "+e,i[n]=!1,console.log(a)},0)};e(c[1]).then(s,s)})}return a[n]}}var i={},a={};return o.$stateful=!0,o}]).filter("unique",function(){return function(e,t){for(var n={},r=[],o=0;o<e.length;o++)"undefined"==typeof n[e[o][t]]&&(n[e[o][t]]="",r.push(e[o]));return r}}).filter("percentage",["$window",function(e){return function(t,n,r){return n=angular.isNumber(n)?n:3,r=r||"%",e.isNaN(t)?"":Math.round(t*Math.pow(10,n+2))/Math.pow(10,n)+r}}])}(angular),function(){"use strict";var e="error",t="/error/:errorId",n="errorCtrl",r="components/errorHandler/error.html";angular.module("quartz.components").controller(n,["$scope","$stateParams",function(e,t){e.error=t}]).config(["$stateProvider",function(o){o.state(e,{url:t,templateUrl:r,controller:n,resolve:{user:["$auth",function(e){return e.waitForAuth()}]}})}]).factory("$errorHandler",["$state",function(e){function t(t){e.go("error",t),$scope.$$phase||$scope.$apply()}return function(e){var n=e||{};return n.type?void(n.openErrorPage&&t(n)):function(e){console.log(JSON.stringify(e))}}}])}(),function(){"use strict";function e(e){this.queryList=function(e){return _core.util.elasticsearch.queryList(e)},this.pagination=function(t,n,r){var o=_core.util.elasticsearch.pagination(t,n,r);return pagination.get=function(t,n,r){var i=o.get(t,n,r);i.then(function(r){pagination.size=n,pagination.page=t,pagination.result={hits:r.hits,total:r.total},e(angular.noop,0)})},pagination}}e.$inject=["$timeout"],angular.module("quartz.components").factory("$elasticSearch",e)}(),function(){"use strict";function e(e){var t={},n={},r=function(e,t){var n=document.createElement("script");return n.id=e,n.type="text/javascript",t&&(n.text=t||""),n};return t.set=function(t,o){var i;return n[t]||(n[t]=e.defer(),i=r(t),i.onload=n[t].resolve,angular.element("head").append(i),i.src=o),n[t].promise},t.setDirectly=function(t,o){if(!n[t]){n[t]=e.defer();var i=r(t,o);n[t].resolve(),angular.element("head").append(i)}return n[t].promise},t}e.$inject=["$q"],angular.module("quartz.components").factory("injectJS",e)}(),function(){"use strict";function e(){function e(e){return"?"==e.charAt(0)?!0:("/"==e.charAt(0)&&(e=e.substring(1)),!!i[e])}function t(e){var t="";return angular.forEach(e,function(e,n){var r="all"===n?"":"-"+n;angular.forEach(e,function(e,n){if(null!==e){var o='="'+e+'" ',i=n+r;switch(n){case"flex":"flex"===e&&(o=" ");break;case"flex-offset":break;case"flex-order":break;case"layout":break;case"layout-align":o='="'+e.x+" "+e.y+'" ';break;default:i=e?i+" ":"",o=""}t+=i+o}})}),t}function n(n){n=n||{};var r,o=n.tag||"div",i=e(o),a=n.type;if("widget"===n.type)return'<custom-widget name="'+n.widget+'"></custom-widget>';if(n.content){if(r=n.content,"text"===a)return r}else r="tag"===a?"<!--include-->":"";var u="";return n.id&&(u+='id="'+n.id+'" '),n.layout&&(u+=t(n.layout)),n.class&&(u+=' class="'+n.class+'"'),n.style&&(u+=' style="'+n.style+'"'),n.attrs&&(u+=" "+n.attrs),n.ctrl&&(u+=' ng-controller="'+n.ctrl+" as "+(n.ctrlAs||"vm")+'"'),-1!==o.search("/")&&(i=!0),r="<--tag-- --custom-->"+(i?"":r+"<--endtag-->"),r=r.replace("--custom--",u),r=r.replace("--tag--",o),r=r.replace("--endtag--","/"+o)}function r(e){var t="";return angular.forEach(e,function(e){var o=n(e);t+=o.replace("<!--include-->",e.divs?r(e.divs):"")}),t}function o(e,t){var o=angular.copy(t)||{};return o.skip?r(e):(o.content="<!--include-->",o.style=o.style||"",$("body,html").addClass("qa-loading"),n(o).replace("<!--include-->",r(e)))}var i={area:1,base:1,basefont:1,br:1,col:1,frame:1,hr:1,img:1,input:1,isindex:1,link:1,meta:1,param:1,embed:1};return{compile:r,compileAll:o,compileTag:n}}angular.module("quartz.components").factory("customService",e)}(),function(){"use strict";function e(e,t,n){function r(e){var t=n.onStart({to:"**"},function(){o.remove(e),t()})}var o={},i=function(e,t){var n=document.createElement("link");return n.id=e,n.rel="stylesheet",n.type="text/css",n.href=t,n},a=function(e,t){var n=document.createElement("style");return n.id=e,n.innerHTML=t||"",n},u=function(e,t,n){for(var r in document.styleSheets){var o=document.styleSheets[r].href||"";if(o.split("/").slice(-1).join()===e)return void t.resolve()}n++,setTimeout(function(){u(e,t,n)},50)};return o.set=function(t,n,o){var a,c=0,s=e.defer();return angular.element("link#"+t).length||(a=i(t,n),a.onload=s.resolve,angular.element("head").append(a)),u(n,s,c),o&&r(),s.promise},o.setDirectly=function(e,t,n){if(angular.element("style#"+e).length)angular.element("style#"+e).remove(),o.setDirectly(e,t);else{var i=a(e,t);angular.element("head").append(i)}n&&r()},o.remove=function(e){angular.element("#"+e).remove()},o}e.$inject=["$q","$rootScope","$transitions"],angular.module("quartz.components").factory("injectCSS",e)}(),function(){"use strict";function e(e,t,n,r,o,i){function a(e,n){var r={};"string"==typeof n?["type","cate","subCate","queryString","tag","sort"].forEach(function(e){var t=n.match(new RegExp(e+"=(.*?);"));t&&(r[e]=t[1])}):r=n;var o=r.sort||("product"===e?"itemId":"id"),i=e+"c"+r.cate+"s"+r.subCate+"q"+r.queryString+"t"+r.tag+"s"+o;return y[i]=y[i]||{},r.type=e,r.index=_core.util.site.siteName,"loaded"===y[i].load?y[i]:void("loading"!==y[i].load&&(y[i].pagination=_core.util.elasticsearch.queryList(r),y[i].get=function(e,n,r){y[i].load="loading";var o=y[i].pagination.get(e,n,r);return o.then(function(r){y[i].load="loaded",y[i].size=n,y[i].page=e,y[i].result={hits:r.hits,total:r.total},t(angular.noop,0)}),o},y[i].get(r.page||1,r.size||5,o)))}function u(e){return angular.extend(e||{},{type:"product"}),a(e)}function c(e){return angular.extend(e||{},{type:"article"}),a(e)}function s(t,n,r){var o=t||"product",i=o+"-categories";if("loaded"===b[o].load){if(angular.isNumber(n)&&angular.isNumber(r))return b[o].categories[n][1][r];if(angular.isNumber(n)&&!angular.isNumber(r))return b[o].categories[n][0]}else if("loading"===b[o].load)return;b[o].load="loading",e.getWithCache(i).then(function(e){b[o].categories=e||[],b[o].load="loaded"})}function l(t){return e.get("product?type=detail&id="+t)}function f(t){return e.get("article?type=detail&id="+t)}function d(){var e=_core.util.site.siteName;return _core.util.site.cache[e]?_core.util.site.cache[e].preload||{}:{}}function g(e,t){var n=t||{};r.go("customPage",{pageName:e||o.pageName,params:angular.isObject(t)?JSON.stringify(n):t})}function p(e,t){return n.signInWithEmailAndPassword(e,t)}function m(e,t){var r=t||{};if($&&$("xs")){var o=window.location.href.split("#")[0]+"#"+config.defaultUrl;return r.popup=!1,r.remember="default",window.location.href=o,n.loginWithProvider(e,r)}return n.loginWithProvider(e,_optn).catch(showError).then(function(e){return n.checkIfAccountExistOnFb(e.user)}).then(n.createAccount)}function h(){return n.signOut()}function v(){return n.currentUser}var $;try{$=i.get("$mdMedia")}catch(w){}var y={},b={article:{},product:{}};return{basics:{queryList:a,queryProduct:u,queryArticle:c,getCate:s,getProduct:l,getArticle:f,getSitePreload:d,go:g},auth:{user:v,login:p,loginWithProvider:m,logout:h}}}function t(e,t,n,r,o,i){function a(){t.siteName&&t.pageName?e.go(t.stateName||"customPage",t):e.go(o.home)}function u(e){l.err=angular.isObject(e)&&e.code?e.code:e+""}function c(e,t){l.err=null,i.login(e,t).then(function(){a()},u)}function s(e){i.loginWithProvider(e,l.loginOption).catch(u).then(function(e){return a(),r.checkIfAccountExistOnFb(e.user)}).then(r.createAccount)}var l=this;l.email=null,l.pass=null,l.confirm=null,l.createMode=!1,l.loginOption={},l.login=c,l.loginWithProvider=s,l.socialLogins=[{provider:"twitter",icon:"fa fa-twitter",color:"#5bc0de",url:"#"},{provider:"facebook",icon:"fa fa-facebook",color:"#337ab7",url:"#"},{provider:"google",icon:"fa fa-google-plus",color:"#e05d6f",url:"#"},{provider:"github",icon:"fa fa-github-alt",color:"#CACACA",url:"#"}],l.qtSettings=n,l.user={email:"",password:""}}e.$inject=["$firebaseStorage","$timeout","$auth","$state","$stateParams","$injector"],t.$inject=["$state","$stateParams","qtSettings","$auth","config","apiService"],angular.module("quartz.components").factory("apiService",e).controller("LoginController",t)}(),function(){"use strict";function e(){function e(){return _core.util.auth.currentUser}function t(){return _core.util.site.siteName}this.updateProfile=function(n,r,o){var i=e(),a=t();if(i.updateProfile({displayName:n.name,photoURL:n.photoURL}).then(function(){}),n.email&&i.updateEmail(n.email),"object"==typeof r&&_core.util.storage.update("site-user?type=detail&siteName="+a+"&userId="+i.uid,r),"object"==typeof o){var u="type=list&siteName="+a+"&userId="+i.uid;_core.util.database.update(["site-user?"+u,"root-user?"+u],o)}},this.changePassword=function(t){var n=e();return n.updatePassword(t)}}angular.module("quartz.components").factory("profile",e)}(),function(){"use strict";function e(e){{var t=firebase.auth(_core.util.app);new Promise(function(e){var n=t.onAuthStateChanged(function(){e(t.currentUser),n()})})}return t.waitForAuth=function(){return Promise.resolve(t.currentUser)},t.requireAuth=function(){return t.currentUser?Promise.resolve(t.currentUser):Promise.reject()},t.checkIfAccountExistOnFb=function(){return _core.util.auth.checkIfAccountExist()},t.createAccount=function(e){return _core.util.auth.createAccount(e)},t.loginWithProvider=function(e,t){return _core.util.auth.loginWithProvider(e,t)},t.removeUserData=function(t,n){var r=t.uid;e.update(["user?type=list","user/type=detail"],{"@all":null},{id:r}).then(function(){n&&n(t)})},t}function t(e,t,r){t.onAuthStateChanged(function(t){e.user=t,e.loggedIn=!!t,t?r.queryRef("user-path?userId="+t.uid+"&path=info").once("value",function(r){var o={},i=t.providerData;o.info=r.val()||{},o.info.name=t.displayName||i[0].displayName||n(t.email),o.info.photoURL=t.photoURL||i[0].photoURL,e.user.info=o.info}):console.log("no user",t)})}function n(e){return e.substring(0,e.indexOf("@"))}e.$inject=["$firebase"],t.$inject=["$rootScope","$auth","$firebase"],angular.module("quartz.components").factory("$auth",e).run(t)}(),function(){"use strict";angular.module("quartz.directives",[])}(),function(){"use strict";function e(e){return{terminal:!0,restrict:"EA",link:function(t,n,r,o,i){return i?void i(function(e){e.length?n.replaceWith(e):n.remove()}):void e.error("orphan","Illegal use of ngTranscludeReplace directive in the template! No parent directive that requires a transclusion found. ")}}}e.$inject=["$log"],angular.module("quartz.directives").directive("ngTranscludeReplace",e)}(),function(){"use strict";function e(e,t){function n(n,r,o){return-1!==o.fsSrc.search("//")?void o.$set("src",o.fsSrc):void e.ref("file-path?path="+o.fsSrc,{isJs:!1}).getMetadata().then(function(e){o.$set("src",e.downloadURLs),t.useBandwidth(e.size)})}return{link:n,restrict:"A"}}function t(e,t){function n(n,r,o){return-1!==o.fsHref.search("//")?void o.$set("href",o.fsHref):void e.ref("file-path?path="+o.fsHref,{isJs:!1}).getMetadata().then(function(e){r.on("click",function(){t.useBandwidth(e.size)}),o.$set("href",e.downloadURLs)})}return{link:n,restrict:"A"}}e.$inject=["$firebaseStorage","$usage"],t.$inject=["$firebaseStorage","$usage"],angular.module("quartz.directives").directive("fsSrc",e).directive("fsHref",t)}(),function(){"use strict";function e(e,t,n,r){function o(o,i,a){var u=a.name;e.getWithCache("widget?type=detail&id="+a.name).then(function(e){var a=t.compileAll(e.content,e.canvas),c=n(a)(o);i.replaceWith(c),r.setDirectly("widget-"+u,e.css)})}return{link:o,restrict:"E"}}e.$inject=["$firebaseStorage","customService","$compile","injectCSS"],angular.module("quartz.directives").directive("customWidget",e)}(),function(){"use strict";angular.module("quartz.profiler",["digestHud"])}(),function(){"use strict";function e(e){e.enable(),e.setHudPosition("top right"),e.numTopWatches=20,e.numDigestStats=25}e.$inject=["digestHudProvider"],angular.module("quartz.profiler").config(e)}(),function(){"use strict";angular.module("app.parts.design",[])}(),function(){"use strict";function e(e,t){window.refreshPreview=function(n){window._previewPageData=n,e.go("previewFrame",t,{reload:!0})},window.parent&&window.parent.initPreviewFrame&&window.parent.initPreviewFrame()}e.$inject=["$state","$stateParams"],angular.module("app.parts.design").run(e)}(),function(){"use strict";function BasicApiController(e,t,n,r,o){angular.forEach(e,function(e,t){o[t]=e}),o.$service=function(e){return t.get(e)},o.test=function(){console.log("test1")}}function CustomPageCtrl(e,t,n,r,o,i,a,u,c,s,l){var f=this;angular.forEach(t,function(e,t){n[t]=e}),f.$service=function(e){return r.get(e)},loadDeferedJs(s,c,l,e.sources),injectCustomJs(r,e.customJs)}function PreviewFrameCtrl(e,t,n,r,o,i,a,u,c){var s=this;angular.forEach(t,function(e,t){a[t]=e}),s.$service=function(e){return n.get(e)};var l=window._previewPageData;e.load("page",c.pageName).then(function(){loadDeferedJs(e,o,r,l.sources),injectCustomJs(n,l.customJs)})}function loadDeferedJs(e,t,n,r){var o=[];angular.forEach(r,function(e){-1!==e.src.search(/.*(\.js$|\.js?)/)&&e.defer&&o.push(e.src)});var i=n.debounce(function(){$(window).trigger("load"),$("body,html").removeClass("qa-loading")},100);e.getDownloadUrls(o).then(function(e){t.load({serie:!0,files:e}).then(i).catch(i)})}function injectCustomJs($injector,customJs){if(customJs){var js;if(-1!==customJs.search("/*@ngController*/"))try{eval("js ="+customJs),(angular.isFunction(js)||angular.isArray(js)&&angular.isFunction(js[js.length]))&&$injector.invoke(js,ctrl,{$scope:$scope})}catch(e){}else try{eval(customJs)}catch(e){}}}BasicApiController.$inject=["apiService","$injector","$auth","$firebaseStorage","$scope","$state","$stateParams"],CustomPageCtrl.$inject=["pageData","apiService","$scope","$injector","customService","$stateParams","$timeout","$state","$ocLazyLoad","$lazyLoad","snippets"],PreviewFrameCtrl.$inject=["$lazyLoad","apiService","$injector","snippets","$ocLazyLoad","injectCSS","$scope","customService","$stateParams","$timeout"],angular.module("app.parts.design").controller("BasicApiController",BasicApiController).controller("CustomPageCtrl",CustomPageCtrl).controller("PreviewFrameController",PreviewFrameCtrl)
}(),function(){"use strict";function e(e){var t=(_core.util.site.domain?"/:pageName":"/"+_core.util.site.siteName+"/:pageName")+"/?params&params2";e.state("previewFrame",{url:"/preview/:siteName/:pageName/?params",views:{root:{controller:"PreviewFrameController",controllerAs:"qa",templateProvider:["pageData","customService",function(e,t){return e?t.compileAll(e.content,e.canvas):""}]}},params:{siteName:"",pageName:"",params:""},resolve:{onSiteReady:["sitesService",function(e){return e.onReady()}],pageData:["sitesService","$lazyLoad","$stateParams",function(){return window._previewPageData}]}}).state("customPage",{url:t,views:{root:{controller:"CustomPageCtrl",controllerAs:"qa",templateProvider:["pageData","customService",function(e,t){return t.compileAll(e.content,e.canvas)}]}},params:{siteName:"",pageName:"",params:""},resolve:{onSiteReady:["sitesService",function(e){return e.onReady()}],pageData:["sitesService","$lazyLoad","$stateParams",function(e,t,n){return new Promise(function(r,o){e.onReady().then(function(){t.load("page",n.pageName).then(function(e){r(e)})}).catch(o)})}]}})}e.$inject=["$stateProvider"],angular.module("app.parts.design").config(e)}(),function(){"use strict";angular.module("quartz",["quartz.components","quartz.directives","ui.router"])}(),function(){"use strict";function e(e,t,n){-1!==t.navigator.platform.indexOf("Win")&&(e.bodyClasses=["os-windows"]),e.debug=n.debug,n.debug&&console.log("debug mode")}e.$inject=["$rootScope","$window","config"],angular.module("quartz").run(e)}(),function(){"use strict";angular.module("app.parts",["app.parts.design"])}(),function(){"use strict";angular.module("app.configs",[])}(),function(){"use strict";function e(e,t,n){function r(e){function t(){e.go("mdDashboard.dashboard-analytics")}var n=this;n.goHome=t}r.$inject=["$state"],n.hashPrefix("!"),e.state("404",{url:"/404",views:{root:{templateUrl:"404.tmpl.html",controller:r,controllerAs:"vm"}}}).state("500",{url:"/500",views:{root:{templateUrl:"500.tmpl.html",controller:r,controllerAs:"vm"}}}),t.otherwise(function(e){{var t=e.get("$state");e.get("$transitions")}setTimeout(function(){t.go("404")},1e3)}),window.addEventListener("hashchange",function(e){var t=/.*?\/\/.*?(\/#!\/|\/)404$/;e.oldURL.match(t)&&!e.newURL.match(t)&&location.reload()})}e.$inject=["$stateProvider","$urlRouterProvider","$locationProvider"],angular.module("app.configs").config(e)}(),function(){"use strict";function e(e,t,n){n.enabled(!1),e.idle(60),e.timeout(864e3)}e.$inject=["IdleProvider","KeepaliveProvider","TitleProvider"],angular.module("app.configs").config(e)}(),function(){"use strict";angular.module("app.tmpl",[]),_core.util=_core.util||new _core.AppUtil,_core.util.site.getSitePreload().then(function(e){console.log(e);var t=[],n=[];e&&e.preset&&Array.isArray(e.preset.dependencies)&&(n=e.preset.dependencies),["app.custom","app.plugins","ngMaterial","md.data.table","angulartics","angulartics.google.analytics"].forEach(function(e){try{angular.module(e),n.push(e)}catch(t){}}),angular.module("app",["quartz","ngAnimate","ngCookies","ngSanitize","ngMessages","ui.router","pascalprecht.translate","oc.lazyLoad","app.parts","app.tmpl","app.configs"].concat(n)),angular.element(document).ready(function(){angular.module("app").constant("config",{debug:!0,shipping:0,taxRate:0,serverFb:"quartz",home:"quartzplayertest",defaultUrl:"/admin/test",loginRedirectState:"authentication.login"}),Promise.all(t).then(function(){angular.bootstrap(document,["app"])})})})}(),angular.module("app.tmpl").run(["$templateCache",function(e){e.put("app/quartz/components/error-handler/error.tmpl.html","<h2>error</h2>\r\n\r\ntype:{{error.type}}<br>\r\ncontent:{{error.message}}\r\n")}]);