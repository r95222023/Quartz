!function(){"use strict";angular.module("quartz.components",["ui.router","pascalprecht.translate"])}(),function(){"use strict";function t(t,e){return function(n){return new Promise(function(r,i){t.ref("file-path?path=il8n/"+n.key+".json").getDownloadURL().then(function(t){e.get(t).then(function(t){r(t.data)},function(t){i(t)})})})}}t.$inject=["$firebaseStorage","$http"],angular.module("quartz.components").factory("fbStorageLoader",t)}(),function(){"use strict";function t(){var t=0;window._FBUsg=this,this.useBandwidth=function(e){t+=angular.isNumber(e)?e:encodeURI(JSON.stringify(e)).split(/%..|./).length-1,console.log("usage:",t)}}angular.module("quartz.components").service("$usage",t)}(),function(){"use strict";function t(t){function e(t){var e={},n=t||{};return _core.util.site.siteName&&(e.siteName=_core.util.site.siteName),n.params?n.params=Object.assign(e,n.params):n=Object.assign(e,n),n}function n(t,n){return _core.util.storage.getWithCache(t,e(n))}function r(t,n,r,i){return _core.util.storage.update(t,n,r,e(i))}function i(t,n){return _core.util.storage.ref(t,e(n))}function a(t){return Array.isArray(t)?t[Math.floor(Math.random()*t.length)]:t}function o(t,e,n,r,o){return new Promise(function(u,s){var c="function"==typeof o?o:function(){},l="function"==typeof r?r:function(){},d=i(t,{isJs:!1}),p=i(e,{isJs:!1});d.getMetadata().then(function(t){var e=a(t.downloadURLs),r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",l(t),r.onload=function(){if(200==this.status){var e=new window.Blob([r.response],{type:t.contentType});p.put(e).on("state_changed",c,s,function(){n&&d.delete(),u()}),u()}},r.addEventListener("error",function(){s("GET error:"+r.status)}),r.send()})})}function u(t,e){return i(t,e).delete()}function s(){for(var t in f)delete f[t].load}function c(t,e){return f[t]=f[t]||{},"loaded"===f[t].load?f[t].val:void("loading"!==f[t].load&&(f[t].load="loading",n(t).then(function(n){f[t]={val:"function"==typeof e?e(n):n,load:"loaded"}})))}function l(t){var e=t+"",n=/url\(['"][\s\S]*?['"]\)/gm,r=e.match(n)||[],i=[];return r.forEach(function(t,e){var n=t.match(/url\(['"]?([\s\S]*?)["']?\)/m)[1];n=n.replace("../",""),i[e]=-1===t.search("//")?p.ref("file-path?path="+n).getDownloadURL():Promise.resolve(n)}),new Promise(function(n,a){r.length?Promise.all(i).then(function(t){t.forEach(function(n,i){e=e.replace(r[i],"url('"+t[i]+"')")}),n(e)}).catch(a):n(t)})}function d(t){var e=new FileReader;return new Promise(function(n){e.addEventListener("loadend",function(e){l(e.srcElement.result).then(function(r){if(r===e.srcElement.result)n(t);else{var i=new Blob([r],{type:"text/css"});n(i)}}).catch(function(e){console.log(e),n(t)})}),e.readAsText(t)})}var p={get:c,getWithCache:n,copy:o,update:r,remove:u,ref:i,getSingleDownloadUrl:a,clearTemp:s,fixCSSFile:d,storages:{}},f={};return window._getFBS=function(e){window._getGetFBS()(e,function(){t(angular.noop,0)})},p}t.$inject=["$timeout"],angular.module("quartz.components").factory("$firebaseStorage",t)}(),function(){"use strict";function t(){function t(t,e){for(var n=t.length;n--;)t[n]===e&&t.splice(n,1)}function e(t){function e(t){var e=Number(t);return!e%1===0&&e>-1?e:!1}function n(t){var r=[],i={},a=!0;return angular.forEach(t,function(t,i){var o=e(i);return o===!1?(a=!1,!1):void(r[i]=angular.isObject(t)?n(t):t)}),a===!1&&angular.forEach(t,function(t,e){i[e]=angular.isObject(t)?n(t):t}),a?r:i}return n(t)}function n(t,e,n){var r;return function(){var i=this,a=arguments,o=function(){r=null,n||t.apply(i,a)},u=n&&!r;clearTimeout(r),r=setTimeout(o,e),u&&t.apply(i,a)}}function r(t){var e=JSON.stringify(t).replace("undefined","null");return JSON.parse(e)}function i(t){return 10>t?"0"+t:t+""}function a(t,e,n){var r=document.createElement("a"),i=t;document.body.appendChild(r),r.style="display: none",""===e.split(".json")[1]&&(i=JSON.stringify(t));var a=new Blob([i],{type:n||"text/plain"}),o=window.URL.createObjectURL(a);r.href=o,r.download=e,r.click(),window.URL.revokeObjectURL(o)}function o(t,e){var n=document.createElement("a");e&&(n.download=e),n.href=t,n.click()}function u(t,e){var n=new XMLHttpRequest;n.responseType="blob",n.onload=function(){var t=new FileReader;t.onloadend=function(){e(t.result)},t.readAsDataURL(n.response)},n.open("GET",t),n.send()}function s(t,e,n){var r=n||"";t&&t._content?angular.forEach(t._content,function(n,i){"__created"!==i&&s(t[i]||n,e,r+"/"+n.name)}):e(t,r)}return{debounce:n,to2dig:i,saveData:a,downloadURI:o,toDataUrl:u,getFirebaseArrayData:e,removeItemFromArray:t,rectifyUpdateData:r,iterateFileTree:s}}angular.module("quartz.components").factory("snippets",t)}(),function(){"use strict";function t(t,e,n,r,i,a,o){function u(){return l.promise}function s(t,n){console.log("Initializing "+t),o.$broadcast("site:change",t),_core.util.site.changeTitle(t),c.siteName=t,c.config={},c.preLoading=!0,"customPage"===n.name||"previewFrame"===n.name?_core.util.site.getSitePreload().then(function(t){var n=t||{};console.log(t),a.loadSite(n).then(function(){if(c.config=n,n.title&&_core.util.site.changeTitle(n.title),n.favicon){var t=n.favicon;-1!==n.favicon.search("//")?_core.util.site.changeFavicon(t):e.ref("file-path?path="+t,{isJs:!1}).getDownloadURL().then(function(t){_core.util.site.changeFavicon(t)})}delete c.preLoading,o.sitesService=c,l.resolve(c)})}):l.resolve(c)}var c={setSite:s,onReady:u,siteName:"_default_"},l=r.defer();return c}function e(t,e,n){t.onBefore({to:"**"},function(t){var e,r=t.to(),i=t.from(),a=t.params("to");n.pageName=a.pageName;var o=_core.util.site.siteName;return o&&""===i.name?n.setSite(o,r):""!==o&&o!==_core.util.site.siteName,e?!1:r})}t.$inject=["$firebase","$firebaseStorage","snippets","$q","indexService","$lazyLoad","$rootScope"],e.$inject=["$transitions","$state","sitesService"],angular.module("quartz.components").service("sitesService",t).run(e)}(),function(){angular.module("quartz.components").config(["$provide",function(t){t.decorator("ngCloakDirective",["$delegate","$auth",function(t,e){var n=t[0],r=n.compile;return n.compile=function(t,i){e.waitForAuth().then(function(){r.call(n,t,i)})},t}])}])}(),function(){"use strict";var t=[];angular.module("quartz.components").config(["$stateProvider",function(e){e.stateAuthenticated=function(n,r){return t.push(n),r.resolve=r.resolve||{},r.resolve.authData=["$auth",function(t){return t.requireAuth()}],e.state(n,r),this}}]).run(["$rootScope","$transitions","$location","$state","$auth","config",function(e,n,r,i,a,o){function u(t){!t&&s(i.current.name)&&(console.log("check failed",t,r.path()),i.go(o.loginRedirectState))}function s(e){return console.log("authRequired?",e,t.indexOf(e)),-1!==t.indexOf(e)}a.onAuthStateChanged(u),n.onError({to:"**"},function(t){"AUTH_REQUIRED"===t.error()&&i.transitionTo(o.loginRedirectState)})}])}(),function(){"use strict";function t(t,e,n){function r(t){var n=[];return t.forEach(function(t,r){n[r]=-1===t.search("//")?e.ref("file-path?path="+t).getDownloadURL():Promise.resolve(t)}),Promise.all(n)}function i(t){if("string"==typeof t)return null!==t.match(/\.css$/);if("object"==typeof t){var e=t.src||t.href;return"stylesheet"===t.rel||null!==e.match(/\.css$/)}}function a(t){if("string"==typeof t)return null!==t.match(/\.js/);if("object"==typeof t){var e=t.src||t.href;return"text/javascript"===t.type||null!==e.match(/\.js$/)}}function o(t,e){var o=t||[],u=[],s=[];return o.forEach(function(t){t.src=t.src||t.href||"",i(t)&&s.push(t.src),a(t)&&!t.defer&&u.push(t.src)}),r(s).then(function(t){t.forEach(function(t,r){n.set("style"+e+r,t,!0)})}),new Promise(function(t,e){r(u).then(function(e){t({serie:!0,files:e})}).catch(e)})}function u(e,r,i){var a=e||{},u=a.sources;n.setDirectly("style"+i,a.css,!0),u?o(u,i).then(function(e){e.files.length?t.load(e).then(function(){r(a),console.log(a)}):r(a)}):r(a)}function s(t,e){return new Promise(function(n){var r=e,i=r.replace(/\s+/g,"");angular.isObject(t)?u(t,n,i):_core.util.site.loadPage("",e).then(function(t){u(t,n,i)})})}function c(e){return new Promise(function(n){e.sources?o(e.sources,"selectedSite").then(function(e){e.files.length?t.load(e).then(function(){n()}):n()}):n()})}return{getDownloadUrls:r,load:s,loadSite:c}}t.$inject=["$ocLazyLoad","$firebaseStorage","injectCSS"],angular.module("quartz.components").factory("$lazyLoad",t)}(),function(){"use strict";function t(t){function e(t,e,n,r){return i("add",r||!1,t,e,n)}function n(t,e,n,r){return i("update",r||!1,t,e,n)}function r(t,e,n){return i("remove",n||!1,t,e)}function i(e,n,r,i,a){if(!n&&!_core.util.site.siteName)return void console.log("Please select a site or enter an index");var o={_state:"index"};return o.index="string"==typeof n?n:_core.util.site.siteName,angular.isString(e)&&(o.task=e),angular.isString(r)&&(o.type=r),angular.isString(i)&&(o.id=i),a&&(o.body=a),t.queryRef("queue-tasks").push(o)}return{add:e,update:n,remove:r}}t.$inject=["$firebase"],angular.module("quartz.components").service("indexService",t)}(),function(){"use strict";angular.module("quartz.components").provider("Keepalive",function(){var t={http:null,interval:600};this.http=function(e){if(!e)throw new Error("Argument must be a string containing a URL, or an object containing the HTTP request configuration.");angular.isString(e)&&(e={url:e,method:"GET"}),e.cache=!1,t.http=e};var e=this.interval=function(e){if(e=parseInt(e),isNaN(e)||0>=e)throw new Error("Interval must be expressed in seconds and be greater than 0.");t.interval=e};this.$get=["$rootScope","$log","$interval","$http",function(n,r,i,a){function o(t,e){n.$broadcast("KeepaliveResponse",t,e)}function u(){n.$broadcast("Keepalive"),angular.isObject(t.http)&&a(t.http).success(o).error(o)}var s={ping:null};return{_options:function(){return t},setInterval:e,start:function(){return i.cancel(s.ping),s.ping=i(u,1e3*t.interval),s.ping},stop:function(){i.cancel(s.ping)},ping:function(){u()}}}]}).provider("Idle",function(){var t={idle:1200,timeout:30,autoResume:"idle",interrupt:"mousemove keydown DOMMouseScroll mousewheel mousedown touchstart touchmove scroll",keepalive:!0},e=this.timeout=function(e){if(e===!1)t.timeout=0;else{if(!(angular.isNumber(e)&&e>=0))throw new Error("Timeout must be zero or false to disable the feature, or a positive integer (in seconds) to enable it.");t.timeout=e}};this.interrupt=function(e){t.interrupt=e};var n=this.idle=function(e){if(0>=e)throw new Error("Idle must be a value in seconds, greater than 0.");t.idle=e};this.autoResume=function(e){t.autoResume=e===!0?"idle":e===!1?"off":e},this.keepalive=function(e){t.keepalive=e===!0},this.$get=["$interval","$log","$rootScope","$document","Keepalive","IdleLocalStorage","$window",function(r,i,a,o,u,s,c){function l(){t.keepalive&&(y.running&&u.ping(),u.start())}function d(){t.keepalive&&u.stop()}function p(){y.idling=!y.idling;var e=y.idling?"Start":"End";a.$broadcast("Idle"+e),y.idling?(d(),t.timeout&&(y.countdown=t.timeout,f(),y.timeout=r(f,1e3,t.timeout,!1))):l(),r.cancel(y.idle)}function f(){return y.countdown<=0?void m():(a.$broadcast("IdleWarn",y.countdown),void y.countdown--)}function m(){d(),r.cancel(y.idle),r.cancel(y.timeout),y.idling=!0,y.running=!1,y.countdown=0,a.$broadcast("IdleTimeout")}function g(t,e,n){var r=t.running();t.unwatch(),e(n),r&&t.watch()}function h(){var t=s.get("expiry");return t&&t.time?new Date(t.time):null}function v(t){t?s.set("expiry",{id:$,time:t}):s.remove("expiry")}var y={idle:null,timeout:null,idling:!1,running:!1,countdown:null},$=(new Date).getTime(),b={_options:function(){return t},_getNow:function(){return new Date},getIdle:function(){return t.idle},getTimeout:function(){return t.timeout},setIdle:function(t){g(this,n,t)},setTimeout:function(t){g(this,e,t)},isExpired:function(){var t=h();return null!==t&&t<=this._getNow()},running:function(){return y.running},idling:function(){return y.idling},watch:function(e){r.cancel(y.idle),r.cancel(y.timeout);var n=t.timeout?t.timeout:0;e||v(new Date((new Date).getTime()+1e3*(t.idle+n))),y.idling?p():y.running||l(),y.running=!0,y.idle=r(p,1e3*t.idle,0,!1)},unwatch:function(){r.cancel(y.idle),r.cancel(y.timeout),y.idling=!1,y.running=!1,v(null),d()},interrupt:function(e){return y.running?t.timeout&&this.isExpired()?void m():void(("idle"===t.autoResume||"notIdle"===t.autoResume&&!y.idling)&&this.watch(e)):void 0}};o.find("html").on(t.interrupt,function(t){"mousemove"===t.type&&t.originalEvent&&0===t.originalEvent.movementX&&0===t.originalEvent.movementY||("mousemove"!==t.type||angular.isUndefined(t.movementX)||t.movementX||t.movementY)&&b.interrupt()});var w=function(t){if("ngIdle.expiry"===t.key&&t.newValue&&t.newValue!==t.oldValue){var e=angular.fromJson(t.newValue);if(e.id===$)return;b.interrupt(!0)}};return c.addEventListener?c.addEventListener("storage",w,!1):c.attachEvent("onstorage",w),b}]}).provider("Title",function(){function t(t,e,n){return new Array(e-String(t).length+1).join(n||"0")+t}var e={enabled:!0},n=this.enabled=function(t){e.enabled=t===!0};this.$get=["$document","$interpolate",function(r,i){var a={original:null,idle:"{{minutes}}:{{seconds}} until your session times out!",timedout:"Your session has expired."};return{setEnabled:n,isEnabled:function(){return e.enabled},original:function(t){return angular.isUndefined(t)?a.original:void(a.original=t)},store:function(t){(t||!a.original)&&(a.original=this.value())},value:function(t){return angular.isUndefined(t)?r[0].title:void(r[0].title=t)},idleMessage:function(t){return angular.isUndefined(t)?a.idle:void(a.idle=t)},timedOutMessage:function(t){return angular.isUndefined(t)?a.timedout:void(a.timedout=t)},setAsIdle:function(e){this.store();var n={totalSeconds:e};n.minutes=Math.floor(e/60),n.seconds=t(e-60*n.minutes,2),this.value(i(this.idleMessage())(n))},setAsTimedOut:function(){this.store(),this.value(this.timedOutMessage())},restore:function(){this.original()&&this.value(this.original())}}}]}).service("IdleStorageAccessor",["$window",function(t){return{get:function(){return t.localStorage}}}]).service("IdleLocalStorage",["IdleStorageAccessor",function(t){function e(){var t={};this.setItem=function(e,n){t[e]=n},this.getItem=function(e){return"undefined"!=typeof t[e]?t[e]:null},this.removeItem=function(e){t[e]=void 0}}function n(){try{var n=t.get();return n.setItem("ngIdleStorage",""),n.removeItem("ngIdleStorage"),n}catch(r){return new e}}var r=n();return{set:function(t,e){r.setItem("ngIdle."+t,angular.toJson(e))},get:function(t){return angular.fromJson(r.getItem("ngIdle."+t))},remove:function(t){r.removeItem("ngIdle."+t)},_wrapped:function(){return r}}}]).run(["$rootScope","Idle",function(t,e){t.$on("IdleStart",function(){console.log("idle start")}),t.$on("IdleEnd",function(){console.log("idle end")}),t.user&&t.user.admin||e.watch()}])}(),function(){"use strict";angular.module("quartz.components").directive("idleCountdown",["Idle",function(t){return{restrict:"A",scope:{value:"=idleCountdown"},link:function(e){e.value=t.getTimeout(),e.$on("IdleWarn",function(t,n){e.$evalAsync(function(){e.value=n})}),e.$on("IdleTimeout",function(){e.$evalAsync(function(){e.value=0})})}}}]).directive("title",["Title",function(t){return{restrict:"E",link:function(e,n,r){t.isEnabled()&&!r.idleDisabled&&(t.store(!0),e.$on("IdleStart",function(){t.original(n[0].innerText)}),e.$on("IdleWarn",function(e,n){t.setAsIdle(n)}),e.$on("IdleEnd",function(){t.restore()}),e.$on("IdleTimeout",function(){t.setAsTimedOut()}))}}}])}(),function(){"use strict";function t(t,e){function n(t,e){var n={},r=e||{};return _core.util.site.siteName&&(n.siteName=_core.util.site.siteName),r.params?r.params=Object.assign(n,r.params):r=Object.assign(n,r),_core.util.database.queryRef(t,r)}function r(t,e,n){var r=_core.util.site.siteName?_core.util.site.siteName:"",i=Object.assign({siteName:r},n),a=Array.isArray(t)?t:[t];return _core.util.database.update(a,e,i)}function i(t,e){return r(t,{compressed:_core.encoding.compress(e),editTime:firebase.database.ServerValue.TIMESTAMP})}function a(t,e,r,i){return new Promise(function(a,o){var u=i||{},s=n(t,u.src);s.once("value").then(function(t){n(e,u.dest)[u.set===!0?"set":"update"](t.val()).then(function(){r?s.set(null).then(a):a()})}).catch(o)})}function o(t,e){return new Promise(function(r,i){var a=e||{},o={},u=n(t,Object.assign(a,{params:a.params||{}}));u.once("value",function(t){t.forEach(function(t){var e=t.val(),n=t.key;o[n]={name:(a.fileName?e[a.fileName]:n)+(a.fileExtension||".js"),date:e.editTime,type:"file"}}),r(o)}).catch(i)})}function u(r,i){function a(e){t(function(){s.result.hits=e.hits||[]},0)}var o=i||{},u=n(r),s=new _core.util.database.Pagination(u,Object.assign({filter:function(t,n){return e("orderBy")(t,n.orderBy)}},o),a);return s.size=10,s.page=1,s.onReorder=function(t){s.get(s.page,s.size,t)},s}function s(t,e){return _core.util.database.request(t,e)}function c(t){var e=t,n=[[/\./g,"^%0"],[/#/g,"^%1"],[/\$/g,"^%2"],[/\[/g,"^%3"],[/\]/g,"^%4"]];return angular.forEach(n,function(t){e=e.replace(t[0],t[1])}),e}function l(t,e){return _core.util.database.getWithCache(t,e)}var d={queryRef:n,update:r,copy:a,getFileTableFromList:o,pagination:u,request:s,updateCacheable:i,getValidKey:c,getWithCache:l};return d}t.$inject=["$timeout","$filter"],angular.module("quartz.components").factory("$firebase",t)}(),function(){"use strict";angular.module("quartz.components").filter("reverse",function(){return function(t){return t.slice().reverse()}}).filter("relativeTime",["$translate","$timeout",function(t,e){function n(t,e){return Math.round(Math.abs(t-e)/1e3)}function r(t,e){var r=e||new Date;t instanceof Date||(t=new Date(t));var i,a=60,o=60*a,u=24*o,s=7*u,c=30*u,l=365*u,d=n(r,t),p=1;return d>u&&s>d&&(t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0),d=n(r,t)),30>d?(i="JUST",p=0):a>d?(i="SECS",p=d):2*a>d?i="MIN":o>d?(i="MINS",p=Math.floor(d/a)):1===Math.floor(d/o)?i="HOUR":u>d?(i="HOURS",p=Math.floor(d/o)):2*u>d?i="DAY":s>d?(i="DAYS",p=Math.floor(d/u)):1===Math.floor(d/s)?i="WEEK":c>d?(i="WEEKS",p=Math.floor(d/s)):1===Math.floor(d/c)?i="MONTH":l>d?(i="MONTHS",p=Math.floor(d/c)):1===Math.floor(d/l)?i="YEAR":(i="YEARS",p=Math.floor(d/l)),[p,"DATE."+i]}function i(n){if(n){if(o[n])return o[n];if(!a[n]){a[n]=!0;var i=new Date(n);_core.syncTime().then(function(u){var s=r(i,new Date(u())),c=function(t){e(function(){o[n]=t.split(" ")[1]||!s[0]?t:s[0]+" "+t,a[n]=!1,console.log(o)},0)};t(s[1]).then(c,c)})}return o[n]}}var a={},o={};return i.$stateful=!0,i}]).filter("unique",function(){return function(t,e){for(var n={},r=[],i=0;i<t.length;i++)"undefined"==typeof n[t[i][e]]&&(n[t[i][e]]="",r.push(t[i]));return r}}).filter("percentage",["$window",function(t){return function(e,n,r){return n=angular.isNumber(n)?n:3,r=r||"%",t.isNaN(e)?"":Math.round(e*Math.pow(10,n+2))/Math.pow(10,n)+r}}])}(angular),function(){"use strict";var t="error",e="/error/:errorId",n="errorCtrl",r="components/errorHandler/error.html";angular.module("quartz.components").controller(n,["$scope","$stateParams",function(t,e){t.error=e}]).config(["$stateProvider",function(i){i.state(t,{url:e,templateUrl:r,controller:n,resolve:{user:["$auth",function(t){return t.waitForAuth()}]}})}]).factory("$errorHandler",["$state",function(t){function e(e){t.go("error",e),$scope.$$phase||$scope.$apply()}return function(t){var n=t||{};return n.type?void(n.openErrorPage&&e(n)):function(t){console.log(JSON.stringify(t))}}}])}(),function(){"use strict";function t(t){this.queryList=function(t){return _core.util.elasticsearch.queryList(t)},this.pagination=function(e,n,r){var i=_core.util.elasticsearch.pagination(e,n,r);return pagination.get=function(e,n,r){var a=i.get(e,n,r);a.then(function(r){pagination.size=n,pagination.page=e,pagination.result={hits:r.hits,total:r.total},t(angular.noop,0)})},pagination}}t.$inject=["$timeout"],angular.module("quartz.components").factory("$elasticSearch",t)}(),function(){"use strict";function t(t){var e={},n={},r=function(t,e){var n=document.createElement("script");return n.id=t,n.type="text/javascript",e&&(n.text=e||""),n};return e.set=function(e,i){var a;return n[e]||(n[e]=t.defer(),a=r(e),a.onload=n[e].resolve,angular.element("head").append(a),a.src=i),n[e].promise},e.setDirectly=function(e,i){if(!n[e]){n[e]=t.defer();var a=r(e,i);n[e].resolve(),angular.element("head").append(a)}return n[e].promise},e}t.$inject=["$q"],angular.module("quartz.components").factory("injectJS",t)}(),function(){"use strict";function t(){function t(t){return"?"==t.charAt(0)?!0:("/"==t.charAt(0)&&(t=t.substring(1)),!!a[t])}function e(t){var e="";return angular.forEach(t,function(t,n){var r="all"===n?"":"-"+n;angular.forEach(t,function(t,n){if(null!==t){var i='="'+t+'" ',a=n+r;switch(n){case"flex":"flex"===t&&(i=" ");break;case"flex-offset":break;case"flex-order":break;case"layout":break;case"layout-align":i='="'+t.x+" "+t.y+'" ';break;default:a=t?a+" ":"",i=""}e+=a+i}})}),e}function n(n){n=n||{};var r,i=n.tag||"div",a=t(i),o=n.type;if("widget"===n.type)return'<custom-widget name="'+n.widget+'"></custom-widget>';if(n.content){if(r=n.content,"text"===o)return r}else r="tag"===o?"<!--include-->":"";var u="";return n.id&&(u+='id="'+n.id+'" '),n.layout&&(u+=e(n.layout)),n.class&&(u+=' class="'+n.class+'"'),n.style&&(u+=' style="'+n.style+'"'),n.attrs&&(u+=" "+n.attrs),n.ctrl&&(u+=' ng-controller="'+n.ctrl+" as "+(n.ctrlAs||"vm")+'"'),-1!==i.search("/")&&(a=!0),r="<--tag-- --custom-->"+(a?"":r+"<--endtag-->"),r=r.replace("--custom--",u),r=r.replace("--tag--",i),r=r.replace("--endtag--","/"+i)}function r(t){var e="";return angular.forEach(t,function(t){var i=n(t);e+=i.replace("<!--include-->",t.divs?r(t.divs):"")}),e}function i(t,e){var i=angular.copy(e)||{};return i.skip?r(t):(i.content="<!--include-->",i.style=i.style||"",$("body,html").addClass("qa-loading"),n(i).replace("<!--include-->",r(t)))}var a={area:1,base:1,basefont:1,br:1,col:1,frame:1,hr:1,img:1,input:1,isindex:1,link:1,meta:1,param:1,embed:1};return{compile:r,compileAll:i,compileTag:n}}angular.module("quartz.components").factory("customService",t)}(),function(){"use strict";function t(t,e,n){function r(t){var e=n.onStart({to:"**"},function(){i.remove(t),e()})}var i={},a=function(t,e){var n=document.createElement("link");return n.id=t,n.rel="stylesheet",n.type="text/css",n.href=e,n},o=function(t,e){var n=document.createElement("style");return n.id=t,n.innerHTML=e||"",n},u=function(t,e,n){for(var r in document.styleSheets){var i=document.styleSheets[r].href||"";if(i.split("/").slice(-1).join()===t)return void e.resolve()}n++,setTimeout(function(){u(t,e,n)},50)};return i.set=function(e,n,i){var o,s=0,c=t.defer();return angular.element("link#"+e).length||(o=a(e,n),o.onload=c.resolve,angular.element("head").append(o)),u(n,c,s),i&&r(),c.promise},i.setDirectly=function(t,e,n){if(angular.element("style#"+t).length)angular.element("style#"+t).remove(),i.setDirectly(t,e);else{var a=o(t,e);angular.element("head").append(a)}n&&r()},i.remove=function(t){angular.element("#"+t).remove()},i}t.$inject=["$q","$rootScope","$transitions"],angular.module("quartz.components").factory("injectCSS",t)}(),function(){"use strict";function t(){function t(){return _core.util.auth.currentUser}function e(){return _core.util.site.siteName}this.updateProfile=function(n,r,i){var a=t(),o=e();if(a.updateProfile({displayName:n.name,photoURL:n.photoURL}).then(function(){}),n.email&&a.updateEmail(n.email),"object"==typeof r&&_core.util.storage.update("site-user?type=detail&siteName="+o+"&userId="+a.uid,r),"object"==typeof i){var u="type=list&siteName="+o+"&userId="+a.uid;_core.util.database.update(["site-user?"+u,"root-user?"+u],i)}},this.changePassword=function(e){var n=t();return n.updatePassword(e)}}angular.module("quartz.components").factory("profile",t)}(),function(){"use strict";function t(t){{var e=firebase.auth(_core.util.app);new Promise(function(t){var n=e.onAuthStateChanged(function(){t(e.currentUser),n()})})}return e.waitForAuth=function(){return Promise.resolve(e.currentUser)},e.requireAuth=function(){return e.currentUser?Promise.resolve(e.currentUser):Promise.reject()},e.checkIfAccountExistOnFb=function(){return _core.util.auth.checkIfAccountExist()},e.createAccount=function(t){return _core.util.auth.createAccount(t)},e.loginWithProvider=function(t,e){return _core.util.auth.loginWithProvider(t,e)},e.removeUserData=function(e,n){var r=e.uid;t.update(["user?type=list","user/type=detail"],{"@all":null},{id:r}).then(function(){n&&n(e)})},e}function e(t,e,r){e.onAuthStateChanged(function(e){t.user=e,t.loggedIn=!!e,e?r.queryRef("user-path?userId="+e.uid+"&path=info").once("value",function(r){var i={},a=e.providerData;i.info=r.val()||{},i.info.name=e.displayName||a[0].displayName||n(e.email),i.info.photoURL=e.photoURL||a[0].photoURL,t.user.info=i.info}):console.log("no user",e)})}function n(t){return t.substring(0,t.indexOf("@"))}t.$inject=["$firebase"],e.$inject=["$rootScope","$auth","$firebase"],angular.module("quartz.components").factory("$auth",t).run(e)}(),function(){"use strict";function t(t,e,n,r,i){function a(t,n){var r={};"string"==typeof n?["type","cate","subCate","queryString","tag","sort"].forEach(function(t){var e=n.match(new RegExp(t+"=(.*?);"));e&&(r[t]=e[1])}):r=n;var i=r.sort||("product"===t?"itemId":"id"),a=t+"c"+r.cate+"s"+r.subCate+"q"+r.queryString+"t"+r.tag+"s"+i;return p[a]=p[a]||{},r.type=t,r.index=_core.util.site.siteName,"loaded"===p[a].load?p[a]:void("loading"!==p[a].load&&(p[a].pagination=_core.util.elasticsearch.queryList(r),p[a].get=function(t,n,r){p[a].load="loading";var i=p[a].pagination.get(t,n,r);return i.then(function(r){p[a].load="loaded",p[a].size=n,p[a].page=t,p[a].result={hits:r.hits,total:r.total},e(angular.noop,0)}),i},p[a].get(r.page||1,r.size||5,i)))}function o(t){return angular.extend(t||{},{type:"product"}),a(t)}function u(t){return angular.extend(t||{},{type:"article"}),a(t)}function s(e,n,r){var i=e||"product",a=i+"-categories";if("loaded"===f[i].load){if(angular.isNumber(n)&&angular.isNumber(r))return f[i].categories[n][1][r];if(angular.isNumber(n)&&!angular.isNumber(r))return f[i].categories[n][0]}else if("loading"===f[i].load)return;f[i].load="loading",t.getWithCache(a).then(function(t){f[i].categories=t||[],f[i].load="loaded"})}function c(e){return t.get("product?type=detail&id="+e)}function l(e){return t.get("article?type=detail&id="+e)}function d(){return n.currentUser}var p={},f={article:{},product:{}};return{queryList:a,queryProduct:o,queryArticle:u,getCate:s,getProduct:c,getArticle:l,auth:n,user:d}}t.$inject=["$firebaseStorage","$timeout","$auth","$state","$stateParams"],angular.module("quartz.components").factory("apiService",t)}(),function(){"use strict";angular.module("quartz.profiler",["digestHud"])}(),function(){"use strict";function t(t){t.enable(),t.setHudPosition("top right"),t.numTopWatches=20,t.numDigestStats=25}t.$inject=["digestHudProvider"],angular.module("quartz.profiler").config(t)}(),function(){"use strict";angular.module("quartz.directives",[])}(),function(){"use strict";function t(t){return{terminal:!0,restrict:"EA",link:function(e,n,r,i,a){return a?void a(function(t){t.length?n.replaceWith(t):n.remove()}):void t.error("orphan","Illegal use of ngTranscludeReplace directive in the template! No parent directive that requires a transclusion found. ")}}}t.$inject=["$log"],angular.module("quartz.directives").directive("ngTranscludeReplace",t)}(),function(){"use strict";function t(t,e){function n(n,r,i){return-1!==i.fsSrc.search("//")?void i.$set("src",i.fsSrc):void t.ref("file-path?path="+i.fsSrc,{isJs:!1}).getMetadata().then(function(t){i.$set("src",t.downloadURLs),e.useBandwidth(t.size)})}return{link:n,restrict:"A"}}function e(t,e){function n(n,r,i){return-1!==i.fsHref.search("//")?void i.$set("href",i.fsHref):void t.ref("file-path?path="+i.fsHref,{isJs:!1}).getMetadata().then(function(t){r.on("click",function(){e.useBandwidth(t.size)}),i.$set("href",t.downloadURLs)})}return{link:n,restrict:"A"}}t.$inject=["$firebaseStorage","$usage"],e.$inject=["$firebaseStorage","$usage"],angular.module("quartz.directives").directive("fsSrc",t).directive("fsHref",e)}(),function(){"use strict";function t(t,e,n,r){function i(i,a,o){var u=o.name;t.getWithCache("widget?type=detail&id="+o.name).then(function(t){var o=e.compileAll(t.content,t.canvas),s=n(o)(i);a.replaceWith(s),r.setDirectly("widget-"+u,t.css)})}return{link:i,restrict:"E"}}t.$inject=["$firebaseStorage","customService","$compile","injectCSS"],angular.module("quartz.directives").directive("customWidget",t)}(),function(){"use strict";angular.module("app.plugins.stripe",[])}(),function(){"use strict";function t(){function t(t){this.defaultConfig=t}var e={key:"pk_test_6pRNASCoBOKtIshFeQd4XMUh",name:"Quartz",description:"",amount:"",locale:"auto",currency:"USD",panelLabel:"{{amount}}",zipCode:!1,billingAddress:!1,shippingAddress:!1,allowRememberMe:!0,bitcoin:!1,alipay:!1,alipayReusable:!1};this.setParams=function(t){e=t},t.prototype.setParams=function(t){this.defaultConfig=t},t.prototype.getPaymentInfo=function(t,e){var n=t.cart?t.cart:{},r=n.items||[],i=e||{},a="";angular.isString(t.description)||angular.isString(i.description)?a=t.description:angular.isFunction(i.description)?a=i.description(t):(angular.forEach(r,function(t){a=a+(i.namePrefix||"")+t.name+(i.namePostfix||" ")+(i.pricePrefix||"$")+t.price+(i.pricePostfix||"")+(i.quantityPrefix||"*")+t.quantity+(i.quantityPostfix||"")+"#"}),a=a.slice(0,-1));var o=0;return angular.isNumber(t.totalAmount)||angular.isNumber(i.totalAmount)?o=t.totalAmount||i.totalAmount:angular.isFunction(i.totalAmount)?o=i.totalAmount(t):angular.forEach(n,function(t){o+=t.quantity*t.price}),angular.extend({},this.defaultConfig,i.paymentParams||{},{description:a,amount:o})},this.$get=function(){return new t(e)}}function e(t){function e(e){var r=t.defer();return n(function(){var t=window.StripeCheckout.configure(e);r.resolve(t)}),r.promise}return e}function n(t){if(window.StripeCheckout)t();else{var e=document.createElement("script");e.type="text/javascript",e.src="https://checkout.stripe.com/checkout.js",document.body.appendChild(e).onload=t}}e.$inject=["$q"],angular.module("app.plugins.stripe").provider("$stripe",t).factory("stripeCheckout",e)}(),function(){"use strict";function t(t,e,n,r){return{restrict:"E",scope:{buildData:"=",token:"="},transclude:!0,templateUrl:function(t,e){return"undefined"==typeof e.templateUrl?"app/plugins/stripe/stripe-checkout.tmpl.html":e.templateUrl},link:function(i){i.checkout=function(){function a(a){var o=a.payment.stripe;angular.isFunction(o.token)||(o.token=angular.isFunction(i.token)?i.token:function(t){a.id=a.id||(new Date).getTime(),a.siteName=r.siteName,a.payment.stripe=t,a.payment.type="stripe",a._state="order_validate";var i=firebase.database().ref().push().key;e.request({paths:["queue-task?id="+i],data:a},["queue-task?id="+i+"/_id"]).then(function(t){console.log(t),n.empty()},function(t){console.log(t)})}),t(o).then(function(t){t.open(o)})}var o=i.buildData();angular.isFunction(o.then)?o.then(function(t){a(t)}):a(o)}}}}t.$inject=["stripeCheckout","$firebase","ngCart","sitesService"],angular.module("app.plugins.stripe").directive("stripeCheckout",t)}(),function(){"use strict";angular.module("app.plugins.stripe").config(["$stripeProvider",function(){}])}(),function(){"use strict";angular.module("app.plugins.ngdisqus",[])}(),function(){"use strict";function t(){function t(){return document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]}function e(){return c||window.disqus_shortname}function n(t,e){return"//"+t+".disqus.com/"+e}function r(t){var e=document.createElement("script");return e.type="text/javascript",e.async=!0,e.src=t,e}function i(t,e){var n,r,i=t.getElementsByTagName("script");for(r=0;r<i.length;r+=1)if(n=i[r],~n.src.indexOf(e))return!0;return!1}function a(t,e,n){window.disqus_identifier=t,window.disqus_url=e,window.disqus_shortname=n}function o(){var t=window.DISQUSWIDGETS;t&&angular.isFunction(t.getCount)&&t.getCount()}function u(t,e){window.DISQUS.reset({reload:!0,config:function(){this.page.identifier=e,this.page.url=t.absUrl()
}})}function s(e,a){var o=t(),u=n(e,a);i(o,u)||o.appendChild(r(u))}var c,l="embed.js",d="count.js";this.setShortname=function(t){c=t},this.$get=["$location",function(t){function n(n){var r=e();if(!angular.isDefined(r))throw new Error("No disqus shortname defined");if(!angular.isDefined(n))throw new Error("No disqus thread id defined");angular.isDefined(window.DISQUS)?u(t,n):(a(n,t.absUrl(),r),s(r,l))}function r(n){a(n,t.absUrl(),c),s(e(),l),s(e(),d),o()}return{commit:n,getShortname:e,loadCount:r}}]}angular.module("app.plugins.ngdisqus").provider("$disqus",t)}(),function(){angular.module("app.plugins.ngdisqus").directive("disqus",["$disqus",function(t){return{restrict:"AC",replace:!0,scope:{id:"=disqus"},template:'<div id="disqus_thread"></div>',link:function(e){e.$watch("id",function(e){angular.isDefined(e)&&t.commit(e)})}}}]).directive("disqusIdentifier",["$disqus",function(t){return{restrict:"A",link:function(e,n,r){t.loadCount(r.disqusIdentifier)}}}])}(),function(){"use strict";angular.module("app.plugins.ngdisqus").config(["$disqusProvider","$locationProvider",function(t){t.setShortname("quartzseed")}])}(),function(){"use strict";angular.module("app.plugins.ngcart",[])}(),function(){"use strict";angular.module("app.plugins.ngcart").provider("$ngCart",function(){this.$get=function(){}}).service("ngCart",["$rootScope","ngCartItem","store","$window",function(t,e,n,r){var i="";t.$on("site:change",function(t,e){i=e}),this.init=function(){this.$cart={shipping:null,taxRate:null,tax:null,items:[]}},this.addItem=function(n,r,i,a,o){var u=this.getItemById(n);if("object"==typeof u)u.setQuantity(a,!1),t.$broadcast("ngCart:itemUpdated",u);else{var s=new e(n,r,i,a,o);this.$cart.items.push(s),t.$broadcast("ngCart:itemAdded",s)}t.$broadcast("ngCart:change",{})},this.getItemById=function(t){var e=this.getCart().items,n=!1;return angular.forEach(e,function(e){e.getId()===t&&(n=e)}),n},this.setShipping=function(t){return this.$cart.shipping=t,this.getShipping()},this.getShipping=function(){return 0==this.getCart().items.length?0:this.getCart().shipping},this.setTaxRate=function(t){return this.$cart.taxRate=+parseFloat(t).toFixed(2),this.getTaxRate()},this.getTaxRate=function(){return this.$cart.taxRate},this.getTax=function(){return+parseFloat(this.getSubTotal()/100*this.getCart().taxRate).toFixed(2)},this.setCart=function(t){return this.$cart=t,this.getCart()},this.getCart=function(){return this.$cart},this.getItems=function(){return this.getCart().items},this.getTotalItems=function(){var t=0,e=this.getItems();return angular.forEach(e,function(e){t+=e.getQuantity()}),t},this.getTotalUniqueItems=function(){return this.getCart().items.length},this.getSubTotal=function(){var t=0;return angular.forEach(this.getCart().items,function(e){t+=e.getTotal()}),+parseFloat(t).toFixed(2)},this.totalCost=function(){return+parseFloat(this.getSubTotal()+this.getShipping()+this.getTax()).toFixed(2)},this.removeItem=function(e){var n=this.$cart.items.splice(e,1)[0]||{};t.$broadcast("ngCart:itemRemoved",n),t.$broadcast("ngCart:change",{})},this.removeItemById=function(e){var n,r=this.getCart();angular.forEach(r.items,function(t,n){t.getId()===e&&(t=r.items.splice(n,1)[0]||{})}),this.setCart(r),t.$broadcast("ngCart:itemRemoved",n),t.$broadcast("ngCart:change",{})},this.empty=function(){t.$broadcast("ngCart:change",{}),this.$cart.items=[],r.localStorage.removeItem(i+"_cart")},this.isEmpty=function(){return this.$cart.items.length>0?!1:!0},this.toObject=function(){if(0===this.getItems().length)return!1;var t=[];return angular.forEach(this.getItems(),function(e){t.push(e.toObject())}),{shipping:this.getShipping(),tax:this.getTax(),taxRate:this.getTaxRate(),subTotal:this.getSubTotal(),totalCost:this.totalCost(),items:t}},this.$restore=function(t){var n=this;n.init(),n.$cart.shipping=t.shipping,n.$cart.tax=t.tax,angular.forEach(t.items,function(t){n.$cart.items.push(new e(t._id,t._name,t._price,t._quantity,t._data))}),this.$save()},this.$save=function(){return n.set(i+"_cart",JSON.stringify(this.getCart()))}}]).factory("ngCartItem",["$rootScope","$log",function(t,e){var n=function(t,e,n,r,i){this.setId(t),this.setName(e),this.setPrice(n),this.setQuantity(r),this.setData(i)};return n.prototype.setId=function(t){t?this._id=t:e.error("An ID must be provided")},n.prototype.getId=function(){return this._id},n.prototype.setName=function(t){t?this._name=t:e.error("A name must be provided")},n.prototype.getName=function(){return this._name},n.prototype.setPrice=function(t){var n=parseFloat(t);n?0>=n?e.error("A price must be over 0"):this._price=n:e.error("A price must be provided")},n.prototype.getPrice=function(){return this._price},n.prototype.setQuantity=function(n,r){var i=parseInt(n);i%1===0?(r===!0?this._quantity+=i:this._quantity=i,this._quantity<1&&(this._quantity=1)):(this._quantity=1,e.info("Quantity must be an integer and was defaulted to 1")),t.$broadcast("ngCart:change",{})},n.prototype.getQuantity=function(){return this._quantity},n.prototype.setData=function(t){t&&(this._data=t)},n.prototype.getData=function(){return this._data?this._data:void e.info("This item has no data")},n.prototype.getTotal=function(){return+parseFloat(this.getQuantity()*this.getPrice()).toFixed(2)},n.prototype.toObject=function(){return{id:this.getId(),name:this.getName(),price:this.getPrice(),quantity:this.getQuantity(),data:this.getData(),total:this.getTotal()}},n}]).service("store",["$window",function(t){return{get:function(e){if(t.localStorage.getItem(e)){var n=angular.fromJson(t.localStorage.getItem(e));return JSON.parse(n)}return!1},set:function(e,n){return void 0===n?t.localStorage.removeItem(e):t.localStorage.setItem(e,angular.toJson(n)),t.localStorage.getItem(e)}}}]).service("fulfilmentProvider",["$injector",function(t){this._obj={service:void 0,settings:void 0},this.setService=function(t){this._obj.service=t},this.setSettings=function(t){this._obj.settings=t},this.checkout=function(){var e=t.get("ngCart.fulfilment."+this._obj.service);return e.checkout(this._obj.settings)}}]).service("ngCart.fulfilment.log",["$q","$log","ngCart",function(t,e,n){this.checkout=function(){var r=t.defer();return e.info(n.toObject()),r.resolve({cart:n.toObject()}),r.promise}}]).service("ngCart.fulfilment.http",["$http","ngCart",function(t,e){this.checkout=function(n){return t.post(n.url,{cart:e.toObject(),options:n.options,payment:n.payment})}}]).service("ngCart.fulfilment.firebase",["$firebase","ngCart",function(t,e){this.checkout=function(n){return t.update(n.refUrl,{cart:e.toObject(),options:n.options||null,payment:n.payment||null})}}])}(),function(){"use strict";angular.module("app.plugins.ngcart").directive("ngcartAddtocart",["ngCart","$mdToast",function(t,e){return{restrict:"E",controller:"CartController",scope:{id:"@",name:"@",quantity:"@",quantityMax:"@",price:"@",data:"="},transclude:!0,link:function(n,r,i,a,o){function u(){return n.inCart()?parseInt(t.getItemById(i.id).getQuantity()):0}n.ngCart=t,n.attrs=i,n.inCart=function(){return t.getItemById(i.id)},n.q=n.inCart()?t.getItemById(i.id).getQuantity():parseInt(n.quantity),n.qtyOpt=[];for(var s=1;s<=n.quantityMax;s++)n.qtyOpt.push(s);n.addToCart=function(r,i,a,o,s){function c(n,o,u){t.addItem(r,i,a,n,s,o),e.show(e.simple().content(u).position("top right").hideDelay(1500))}parseInt(o)+u()>n.quantityMax?c(parseInt(n.quantityMax),!1,"max quantity reached"):c(o,!0,"item added ")},o(n,function(t){r.append(t)})}}}]).directive("ngcartCart",[function(){return{restrict:"E",controller:"CartController",scope:{},templateUrl:function(t,e){return"undefined"==typeof e.templateUrl?"app/plugins/ngcart/cart.tmpl.html":e.templateUrl},link:function(){}}}]).directive("ngcartSummary",[function(){return{restrict:"E",controller:"CartController",scope:{},transclude:!0,templateUrl:function(t,e){return"undefined"==typeof e.templateUrl?"app/plugins/ngcart/summary.tmpl.html":e.templateUrl}}}]).directive("ngcartCheckout",[function(){return{restrict:"E",controller:["$rootScope","$scope","ngCart","fulfilmentProvider",function(t,e,n,r){e.ngCart=n,e.checkout=function(){r.setService(e.service),r.setSettings(e.settings),r.checkout().then(function(e){t.$broadcast("ngCart:checkout_succeeded",e)},function(e,n){t.$broadcast("ngCart:checkout_failed",{statusCode:n,error:e})})}}],scope:{service:"@",settings:"="},transclude:!0,templateUrl:function(t,e){return"undefined"==typeof e.templateUrl?"app/plugins/ngcart/checkout.tmpl.html":e.templateUrl}}}])}(),function(){"use strict";function t(t,e){t.ngCart=e}function e(){}function n(t){function e(){var e;t.$watch("vm.query.filter",function(t,n){n||(e=r.query.page),t!==n&&(r.query.page=1),t||(r.query.page=e)})}function n(){r.filter.show=!1,r.query.filter="",r.filter.form.$dirty&&r.filter.form.$setPristine()}var r=this;r.query={filter:"",limit:"10",order:"-id",page:1},r.selected=[],r.filter={options:{debounce:500}},r.removeFilter=n,e()}t.$inject=["$scope","ngCart"],e.$inject=["$scope","ngCart"],n.$inject=["$scope","$timeout","$q"],angular.module("app.plugins.ngcart").controller("CartController",t).controller("AddToCartController",e).controller("CartTableAdvancedController",n)}(),function(){"use strict";angular.module("app.plugins.ngcart").run(["$rootScope","ngCart","ngCartItem","store",function(t,e,n,r){function i(t){angular.isObject(r.get(t+"_cart"))?e.$restore(r.get(t+"_cart")):e.init()}t.$on("ngCart:change",function(){e.$save()}),t.$on("site:change",function(t,e){i(e)}),i("main")}]).value("version","1.0.0")}(),function(){"use strict";angular.module("app.plugins.allpay",["app.plugins.ngcart"])}(),function(){"use strict";function t(){function t(t,e){this.defaultConfig=t,this.getSite=function(){return e.siteName}}var e=!0,n={};this.isStage=function(t){e=!!t},this.setParams=function(t){n=t},t.prototype.getPaymentInfo=function(t,e){function n(t){return 10>t?"0"+t:t}var r=t.items||{},i=e||{},a=i.timeStamp?new Date(i.timeStamp):new Date,o=n(a.getMonth()+1),u=n(a.getDate()),s=n(a.getHours()),c=n(a.getMinutes()),l=n(a.getSeconds()),d=a.getFullYear()+"/"+o+"/"+u+" "+s+":"+c+":"+l,p="";for(var f in r)p=p+(i.namePrefix||"")+r[f].name+(i.namePostfix||" ")+(i.pricePrefix||"$")+r[f].price+(i.pricePostfix||"")+(i.quantityPrefix||"*")+r[f].quantity+(i.quantityPostfix||"")+"#";p=p.slice(0,-1);var m=angular.extend({},this.defaultConfig,i.paymentParams||{},{ReturnURL:this.defaultConfig.ReturnURL+"?sitename="+this.getSite()+"&uid="+t.clientInfo.uid,PaymentInfoURL:this.defaultConfig.PaymentInfoURL+"?sitename="+this.getSite()+"&uid="+t.clientInfo.uid,MerchantTradeDate:d,TotalAmount:_order.totalAmount||0});return m.MerchantTradeNo=t.id,m.ItemName=m.ItemName||p||"required, please set a value",m},this.$get=["sitesService",function(e){return new t(n,e)}]}angular.module("app.plugins.allpay").provider("$allpay",t)}(),function(){"use strict";function t(t,e,n,r,i,a,o,u){return{restrict:"E",scope:{buildData:"=",direct:"@"},transclude:!0,templateUrl:function(t,e){return"undefined"==typeof e.templateUrl?"app/plugins/allpay/allpayCheckout.tmpl.html":e.templateUrl},link:function(r,s,c){function l(){var t=i.defer(),n=firebase.database().ref().push().key;return e.request({paths:["queue-task?id="+n],data:d(vm.order)},["queue-task?id="+n+"/payment/allpay/CheckMacValue"]).then(function(e){r.data.payment.allpay.CheckMacValue=e[0],r.data._id=n,console.log("order mac: "+e[0]),t.resolve(r.data)},function(e){t.reject(e),console.log(e)}),t.promise}function d(e){var n={payment:{allpay:{}}};return angular.extend(n,e),n.payment.allpay.DeviceSource=t("xs")?"M":"P",n.id=e.id||e.payment.allpay.MerchantTradeNo,n.siteName=u.siteName,n.payment.type="allpay",n._state="order_validate",a.rectifyUpdateData(n)}function p(t){function i(t,r,i,a){t.data=i,t.allpayFormAction=n.trustAsResourceUrl(f);var o=!1;t.onFormReady=function(){o||(o=!0,l(i).then(function(e){t.data=e}))},t.submit=function(){t.closeDialog();var e=document.getElementsByName("allpay-checkout");e[0].submit(),a.empty()},t.closeDialog=function(){e.queryRef("queue-task?id="+i._id).child("status").set("canceled"),r.hide()}}i.$inject=["$scope","$mdDialog","data","ngCart"];var a=angular.element(document.body);l().then(function(){o.show({parent:a,targetEvent:t,template:'<md-dialog aria-label="List dialog">  <input><form name="allpay-checkout" ng-submit="submit()" target="_blank" method="post" action="{{allpayFormAction}}"><input ng-repeat="(name, value) in data.payment.allpay" name="{{name}}" value="{{value}}"></form><form name="form" class="css-form" novalidate>E-mail: <input type="email" ng-model="data.userInfo.email" name="uEmail" required="" /><div ng-show="form.$submitted || form.uEmail.$touched"><span ng-show="form.uEmail.$error.required">Email is required.</span><span ng-show="form.uEmail.$error.email">Invalid email.</span></div>I agree:<input type="checkbox" ng-model="data.userInfo.agree" name="userAgree" required="" /><div ng-show="!data.userInfo.agree">You need to agree term of use.</div></div></form>  </md-dialog-content>  <md-dialog-actions>    <input class="md-button md-raised" ng-disabled="form.$invalid" ng-click="submit()" type="submit" value="Submit">    <md-button ng-click="closeDialog()" class="md-primary">      Cancel    </md-button>  </md-dialog-actions></md-dialog>',locals:{data:r.data},controller:i})})}r.getCheckMacValue=l,r.showDialog=function(t){var e=r.buildData();angular.isFunction(e.then)?e.then(function(e){r.data=e,p(t)}):(r.data=e,p(t))};var f=""!==c.stage?"https://payment.allpay.com.tw/Cashier/AioCheckOut":"https://payment-stage.allpay.com.tw/Cashier/AioCheckOut";r.allpayFormAction=n.trustAsResourceUrl(f)}}}t.$inject=["$mdMedia","$firebase","$sce","$timeout","$q","snippets","$mdDialog","sitesService"],angular.module("app.plugins.allpay").directive("allpayCheckout",t)}(),function(){"use strict";function t(t,e,n,r,i,a){function o(t){var n=l.order.items||{},i=t||{},a="";for(var o in n)a=a+(i.namePrefix||"")+n[o].name+(i.namePostfix||" ")+(i.pricePrefix||"$")+n[o].price+(i.pricePostfix||"")+(i.quantityPrefix||"*")+n[o].quantity+(i.quantityPostfix||"")+"#";var u=Object.assign({},defaultAllpayParams,{ReturnURL:"http://131.193.191.5/planAllpayReceive?sitename="+d+"&uid="+e.currentUser.uid,PaymentInfoURL:"http://131.193.191.5/allpayPaymentInfo?sitename="+d+"&uid="+e.currentUser.uid,PaymentType:"aio"});return u.DeviceSource=r("xs")?"M":"P",u.ItemName=u.ItemName||a||"required, please set a value",u.MerchantTradeNo=l.order.id,u}function u(){return l.order.id=l.order.id||_core.getSyncTime(),t.$cart.items.forEach(function(t){l.order.items[t.getId()]=t.toObject()}),l.order.buyer.id=e.currentUser.uid,l.order.siteName=d,l.order.payer.id=e.currentUser.uid,l.order.payment={provider:"allpay",allpay:o()},l.order}function s(t){var e={payment:{allpay:{}}};return angular.extend(e,t),e._state="order_allpay_gen_check_mac",a.rectifyUpdateData(e)}function c(){return new Promise(function(t){u();var e=n.queryRef("queue-task?id="+l.order.id);e.set(s(l.order)).then(function(){var n=function(r){r.val()&&r.val().payment.allpay.CheckMacValue&&(l.order.payment.allpay=r.val().payment.allpay,i(angular.noop,0),console.log(l.order.payment.allpay),e.off("value",n),t(l.order))};e.on("value",n)})})}var l=this,d=_core.util.site.siteName;l.order={vendor:{},buyer:{},shipping:{},payment:{}},l.submit=function(){var t=document.getElementsByName("allpay-checkout");t[0].submit()},l.showDialog=function(t){function e(t,e,n){var r=l.stage?"https://payment-stage.allpay.com.tw/Cashier/AioCheckOut":"https://payment.allpay.com.tw/Cashier/AioCheckOut";t.allpayFormAction=$sce.trustAsResourceUrl(r),c().then(function(e){t.data=e}),t.submit=function(){t.closeDialog();var e=document.getElementsByName("allpay-checkout");e[0].submit(),n.empty()},t.closeDialog=function(){e.hide()}}e.$inject=["$scope","$mdDialog","ngCart"];var n=angular.element(document.body);$mdDialog.show({parent:n,targetEvent:t,templateUrl:"app/plugins/allpay/allpayDialog.tmpl.html",controller:e})}}t.$inject=["$ngCart","$auth","$firebase","$mdMedia","$timeout","snippets"],angular.module("app.plugins.allpay").provider("AllpayCtrl",t)}(),function(){"use strict";angular.module("app.plugins.allpay").config(["$allpayProvider",function(t){t.isStage(!0),t.setParams({MerchantID:"2000132",PaymentType:"aio",ReturnURL:"http://http://24.14.103.233/allpayReceive",PaymentInfoURL:"http://24.14.103.233/allpayPaymentInfo",ChoosePayment:"ALL",NeedExtraPaidInfo:"Y",TradeDesc:"required, please set a value."})}])}(),function(){"use strict";angular.module("app.parts.design",[])}(),function(){"use strict";function t(t,e){window.refreshPreview=function(n){window._previewPageData=n,t.go("previewFrame",e,{reload:!0})},window.parent&&window.parent.initPreviewFrame&&window.parent.initPreviewFrame()}t.$inject=["$state","$stateParams"],angular.module("app.parts.design").run(t)}(),function(){"use strict";function BasicApiController(t,e,n,r,i){angular.forEach(t,function(t,e){i[e]=t}),i.$service=function(t){return e.get(t)},i.test=function(){console.log("test1")}}function CustomPageCtrl(t,e,n,r,i,a,o,u,s,c,l){var d=this;angular.forEach(e,function(t,e){d[e]=t}),d.$service=function(t){return r.get(t)},loadDeferedJs(c,s,l,t.sources),injectCustomJs(r,t.customJs)}function PreviewFrameCtrl(t,e,n,r,i,a,o,u,s){var c=this;angular.forEach(e,function(t,e){c[e]=t}),c.$service=function(t){return n.get(t)};var l=window._previewPageData;t.load("page",s.pageName).then(function(){loadDeferedJs(t,i,r,l.sources),injectCustomJs(n,l.customJs)})}function loadDeferedJs(t,e,n,r){var i=[];angular.forEach(r,function(t){-1!==t.src.search(/.*(\.js$|\.js?)/)&&t.defer&&i.push(t.src)});var a=n.debounce(function(){$(window).trigger("load"),$("body,html").removeClass("qa-loading")},100);t.getDownloadUrls(i).then(function(t){e.load({serie:!0,files:t}).then(a).catch(a)})}function injectCustomJs($injector,customJs){if(customJs){var js;if(-1!==customJs.search("/*@ngController*/"))try{eval("js ="+customJs),(angular.isFunction(js)||angular.isArray(js)&&angular.isFunction(js[js.length]))&&$injector.invoke(js,ctrl,{$scope:$scope})}catch(e){}else try{eval(customJs)}catch(e){}}}BasicApiController.$inject=["apiService","$injector","$auth","$firebaseStorage","$scope","$state","$stateParams"],CustomPageCtrl.$inject=["pageData","apiService","$scope","$injector","customService","$stateParams","$timeout","$state","$ocLazyLoad","$lazyLoad","snippets"],PreviewFrameCtrl.$inject=["$lazyLoad","apiService","$injector","snippets","$ocLazyLoad","injectCSS","$scope","customService","$stateParams","$timeout"],angular.module("app.parts.design").controller("BasicApiController",BasicApiController).controller("CustomPageCtrl",CustomPageCtrl).controller("PreviewFrameController",PreviewFrameCtrl)}(),function(){"use strict";function t(t){var e=(_core.util.site.domain?"/:pageName":"/"+_core.util.site.siteName+"/:pageName")+"/?params&params2";t.state("previewFrame",{url:"/preview/:siteName/:pageName/?params",views:{root:{controller:"PreviewFrameController",controllerAs:"qa",templateProvider:["pageData","customService",function(t,e){return t?e.compileAll(t.content,t.canvas):""}]}},params:{siteName:"",pageName:"",params:""},resolve:{onSiteReady:["sitesService",function(t){return t.onReady()}],pageData:["sitesService","$lazyLoad","$stateParams",function(){return window._previewPageData}]}}).state("customPage",{url:e,views:{root:{controller:"CustomPageCtrl",controllerAs:"qa",templateProvider:["pageData","customService",function(t,e){return e.compileAll(t.content,t.canvas)}]}},params:{siteName:"",pageName:"",params:""},resolve:{onSiteReady:["sitesService",function(t){return t.onReady()}],pageData:["sitesService","$lazyLoad","$stateParams",function(t,e,n){return new Promise(function(r,i){t.onReady().then(function(){e.load("page",n.pageName).then(function(t){r(t)})}).catch(i)})}]}})}t.$inject=["$stateProvider"],angular.module("app.parts.design").config(t)}(),function(){"use strict";angular.module("quartz",["quartz.components","quartz.directives","ui.router"])}(),function(){"use strict";function t(t,e,n){-1!==e.navigator.platform.indexOf("Win")&&(t.bodyClasses=["os-windows"]),t.debug=n.debug,n.debug&&console.log("debug mode")}t.$inject=["$rootScope","$window","config"],angular.module("quartz").run(t)}(),function(){"use strict";angular.module("app.parts",["app.parts.design"])}(),function(){"use strict";angular.module("app.configs",[])}(),function(){"use strict";function t(t,e,n){function r(t){function e(){t.go("mdDashboard.dashboard-analytics")}var n=this;n.goHome=e}r.$inject=["$state"],n.hashPrefix("!"),t.state("404",{url:"/404",views:{root:{templateUrl:"404.tmpl.html",controller:r,controllerAs:"vm"}}}).state("500",{url:"/500",views:{root:{templateUrl:"500.tmpl.html",controller:r,controllerAs:"vm"}}}),e.otherwise(function(t){{var e=t.get("$state");t.get("$transitions")}setTimeout(function(){e.go("404")},1e3)}),window.addEventListener("hashchange",function(t){var e=/.*?\/\/.*?(\/#!\/|\/)404$/;t.oldURL.match(e)&&!t.newURL.match(e)&&location.reload()})}t.$inject=["$stateProvider","$urlRouterProvider","$locationProvider"],angular.module("app.configs").config(t)}(),function(){"use strict";function t(t,e,n){n.enabled(!1),t.idle(60),t.timeout(864e3)}t.$inject=["IdleProvider","KeepaliveProvider","TitleProvider"],angular.module("app.configs").config(t)}(),function(){"use strict";angular.module("app.tmpl",[]),_core.util=_core.util||new _core.AppUtil,_core.util.site.getSitePreload().then(function(t){console.log(t);var e=[],n=[];t&&t.preset&&Array.isArray(t.preset.dependencies)&&(n=t.preset.dependencies),["app.custom","ngMaterial","md.data.table","angulartics","angulartics.google.analytics"].forEach(function(t){try{angular.module(t),n.push(t)}catch(e){}}),angular.module("app",["quartz","ngAnimate","ngCookies","ngSanitize","ngMessages","ui.router","pascalprecht.translate","oc.lazyLoad","app.parts","app.tmpl","app.configs"].concat(n)),angular.element(document).ready(function(){angular.module("app").constant("config",{debug:!0,shipping:0,taxRate:0,serverFb:"quartz",home:"quartzplayertest",defaultUrl:"/admin/test",loginRedirectState:"authentication.login"}),Promise.all(e).then(function(){angular.bootstrap(document,["app"])})})})}(),angular.module("app.tmpl").run(["$templateCache",function(t){t.put("app/plugins/allpay/allpayCheckout.tmpl.html",'<md-button class="md-raised" ng-click="showDialog($event)">allpay</md-button>\r\n'),t.put("app/plugins/allpay/allpayDialog.tmpl.html",'<md-dialog aria-label="List dialog" ng-if="data.payment.allpay">\n    <input>\n    <form name="allpay-checkout" ng-submit="submit()" target="_blank" method="post" action="{{allpayFormAction}}">\n        <input ng-repeat="(name, value) in data.payment.allpay" name="{{name}}" value="{{value}}">\n    </form>\n    </md-dialog-content>\n    <md-dialog-actions>\n        <input class="md-button md-raised" ng-click="submit()" type="submit" value="Submit">\n        <md-button ng-click="closeDialog()" class="md-primary">\n            Cancel\n        </md-button>\n    </md-dialog-actions>\n</md-dialog>\n'),t.put("app/plugins/ngcart/addtocart.tmpl.html",'<div ng-hide="attrs.id">\n    <md-button class="md-raised" ng-disabled="true" ng-transclude></md-button>\n</div>\n<div ng-show="attrs.id">\n    <div>\n        <md-input-container ng-show="quantityMax">\n            <label>Quantity</label>\n            <md-select name="quantity" id="quantity" ng-model="q">\n                <md-option ng-repeat="v in qtyOpt" value="{{v}}">{{v}}</md-option>\n            </md-select>\n        </md-input-container>\n\n\n        <md-button class="md-raised"\n                   ng-click="addToCart(id, name, price, q, data, true)"\n                   ng-transclude>Add</md-button>\n        <!--<md-button class="md-raised" ng-click="ngCart.removeItemById(id)" style="cursor: pointer;">Remove</md-button>-->\n    </div>\n</div>\n'),t.put("app/plugins/ngcart/cart.tmpl.html",'<div class="alert alert-warning" role="alert" ng-show="ngCart.getTotalItems() === 0">\r\n    Your cart is empty\r\n</div>\r\n\r\n\r\n<div ng-controller="CartTableAdvancedController as vm" ng-show="ngCart.getTotalItems() > 0">\r\n    <md-toolbar class="md-table-toolbar md-default">\r\n        <div class="md-toolbar-tools">\r\n            <span>Shopping Cart</span>\r\n        </div>\r\n    </md-toolbar>\r\n\r\n    <md-toolbar class="md-table-toolbar md-default" ng-show="vm.filter.show && !vm.selected.length">\r\n        <div class="md-toolbar-tools">\r\n            <md-input-container flex>\r\n                <label>search</label>\r\n                <input ng-model="vm.query.filter">\r\n            </md-input-container>\r\n            <md-button class="md-icon-button" ng-click="vm.removeFilter()">\r\n                <md-icon md-font-icon="zmdi zmdi-close"></md-icon>\r\n            </md-button>\r\n        </div>\r\n\r\n    </md-toolbar>\r\n\r\n\r\n    <md-table-container>\r\n        <table md-table class="md-primary md-data-table" md-progress="vm.deferred">\r\n            <thead>\r\n            <tr md-row>\r\n                <th></th>\r\n                <th>Item Name</th>\r\n                <th>Quantity</th>\r\n                <th>Amount</th>\r\n                <th>Total</th>\r\n            </tr>\r\n            </thead>\r\n            <tbody md-body>\r\n            <tr md-row ng-repeat="item in ngCart.getCart().items track by $index">\r\n                <td md-cell><span ng-click="ngCart.removeItemById(item.getId())" class="zmdi zmdi-delete"></span></td>\r\n\r\n                <td md-cell>{{ item.getName() }}</td>\r\n                <td md-cell>\r\n                    <md-icon md-font-icon="zmdi zmdi-minus" ng-class="{\'disabled\':item.getQuantity()==1}"\r\n                             ng-click="item.setQuantity(-1, true)"></md-icon>\r\n                    &nbsp;&nbsp;\r\n                    {{ item.getQuantity() | number }}&nbsp;&nbsp;\r\n                    <md-icon md-font-icon="zmdi zmdi-plus" ng-click="item.setQuantity(1, true)"></md-icon>\r\n                </td>\r\n                <td md-cell>{{ item.getPrice() | currency}}</td>\r\n                <td md-cell>{{ item.getTotal() | currency }}</td>\r\n            </tr>\r\n            </tbody>\r\n        </table>\r\n    </md-table-container>\r\n\r\n    <md-table-pagination md-limit="vm.query.limit" md-page="vm.query.page" md-total="{{ngCart.getTotalItems()}}"\r\n                         md-trigger="vm.getUsers"></md-table-pagination>\r\n\r\n</div>\r\n\r\n'),t.put("app/plugins/ngcart/checkout.tmpl.html",'\r\n<div ng-if="service==\'http\' || service == \'log\'">\r\n    <button class="btn btn-primary" ng-click="checkout()" ng-disabled="!ngCart.getTotalItems()" ng-transclude>Checkout</button>\r\n</div>\r\n\r\n\r\n<div ng-if="service==\'paypal\'">\r\n\r\n    <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top" ng-show="ngCart.getTotalItems()">\r\n        <input type="hidden" name="cmd" value="_xclick" />\r\n        <input type="hidden" name="business" value="{{ settings.paypal.business }}" />\r\n        <input type="hidden" name="lc" value="CA" />\r\n        <input type="hidden" name="item_name" value="{{ settings.paypal.item_name }}" />\r\n        <input type="hidden" name="item_number" value="{{ settings.paypal.item_number }}" />\r\n        <input type="hidden" name="amount" value="{{ ngCart.getSubTotal()}}" />\r\n        <input type="hidden" name="currency_code" value="{{ settings.paypal.currency_code }}" />\r\n        <input type="hidden" name="button_subtype" value="services" />\r\n        <input type="hidden" name="no_note" value="{{ settings.paypal.no_note }}" />\r\n        <input type="hidden" name="tax_rate" value="{{ ngCart.getTaxRate()}}" />\r\n        <input type="hidden" name="shipping" value="{{ ngCart.getShipping()}}" />\r\n        <input type="hidden" name="bn" value="PP-BuyNowBF:btn_buynowCC_LG.gif:NonHostedGuest" />\r\n        <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_buynowCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!" />\r\n        <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1" />\r\n    </form>\r\n\r\n</div>\r\n'),t.put("app/plugins/ngcart/summary.tmpl.html",'<div class="row">\r\n    <div class="col-sm-6 text-right">\r\n        <svg version="1.1"  class="icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="30px" height="30px" xml:space="preserve">\r\n			<path d="M27.715,10.48l-2.938,6.312c-0.082,0.264-0.477,0.968-1.318,0.968H11.831\r\n				c-0.89,0-1.479-0.638-1.602-0.904l-2.048-6.524C7.629,8.514,8.715,7.933,9.462,7.933c0.748,0,14.915,0,16.805,0\r\n				C27.947,7.933,28.17,9.389,27.715,10.48L27.715,10.48z M9.736,9.619c0.01,0.061,0.026,0.137,0.056,0.226l1.742,6.208\r\n				c0.026,0.017,0.058,0.028,0.089,0.028h11.629l2.92-6.27c0.025-0.073,0.045-0.137,0.053-0.192H9.736L9.736,9.619z M13.544,25.534\r\n				c-0.819,0-1.482-0.662-1.482-1.482s0.663-1.484,1.482-1.484c0.824,0,1.486,0.664,1.486,1.484S14.369,25.534,13.544,25.534\r\n				L13.544,25.534z M23.375,25.534c-0.82,0-1.482-0.662-1.482-1.482s0.662-1.484,1.482-1.484c0.822,0,1.486,0.664,1.486,1.484\r\n				S24.197,25.534,23.375,25.534L23.375,25.534z M24.576,21.575H13.965c-2.274,0-3.179-2.151-3.219-2.244\r\n				c-0.012-0.024-0.021-0.053-0.028-0.076c0,0-3.56-12.118-3.834-13.05c-0.26-0.881-0.477-1.007-1.146-1.007H2.9\r\n				c-0.455,0-0.82-0.364-0.82-0.818s0.365-0.82,0.82-0.82h2.841c1.827,0,2.4,1.103,2.715,2.181\r\n				c0.264,0.898,3.569,12.146,3.821,12.999c0.087,0.188,0.611,1.197,1.688,1.197h10.611c0.451,0,0.818,0.368,0.818,0.818\r\n				C25.395,21.21,25.027,21.575,24.576,21.575L24.576,21.575z"/>\r\n</svg>\r\n    </div>\r\n    <div class="col-sm-6">{{ ngCart.getTotalItems() }}\r\n        <ng-pluralize count="ngCart.getTotalItems()" when="{1: \'item\', \'other\':\'items\'}"></ng-pluralize>\r\n        <br />{{ ngCart.totalCost() | currency }}\r\n    </div>\r\n</div>\r\n'),t.put("app/plugins/stripe/stripe-checkout.tmpl.html",'<md-button class="md-raised" ng-click="checkout()">stripe</md-button>\r\n'),t.put("app/quartz/components/error-handler/error.tmpl.html","<h2>error</h2>\r\n\r\ntype:{{error.type}}<br>\r\ncontent:{{error.message}}\r\n")}]);